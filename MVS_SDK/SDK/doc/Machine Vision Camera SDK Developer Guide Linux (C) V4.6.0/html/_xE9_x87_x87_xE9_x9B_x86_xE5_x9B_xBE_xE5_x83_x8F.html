<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="custom-style.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
	<div style="overflow: hidden;">
		<div style="height: 57px;min-width: 1039px;background-size: auto 100%;background:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABwgAAAABCAYAAADKO/rAAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABRSURBVFhH7dUxCoBADEXB5LK5/w1iIaLIrsgWNs50Sf/4WVUd8HOZGd1nCqMbGNMPrNMPrJv1cvz0A3OjfuwPvDPrxf7A7t7IlX7gmX74VsQGguw4S6+UnSYAAAAASUVORK5CYII=');">
			<img src="titleleft.png" style="float: left;"/>
			<img src="titleright.png" alt="" style="float: right;" />
		</div>
	</div>
<!-- Generated by Doxygen 1.8.15 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home&#160;Page</span></a></li>
      <li><a href="_xE5_x8F_x91_xE7_x89_x88_xE8_xAF_xB4_xE6_x98_x8E.html"><span>Release&#160;Notes</span></a></li>
      <li><a href="_xE7_x8E_xAF_xE5_xA2_x83_xE9_x85_x8D_xE7_xBD_xAE.html"><span>Envrionment&#160;Configuration</span></a></li>
      <li><a href="_xE7_xBC_x96_xE7_xA8_x8B_xE5_xBC_x95_xE5_xAF_xBC.html"><span>Programming&#160;Guide</span></a></li>
      <li><a href="modules.html"><span>API&#160;Reference</span></a></li>
      <li><a href="_xE7_x9B_xB8_xE6_x9C_xBA_xE5_x8F_x82_xE6_x95_xB0_xE8_x8A_x82_xE7_x82_xB9_xE8_xA1_xA8.html"><span>Camera&#160;Parameter&#160;Node&#160;Table</span></a></li>
      <li><a href="_xE7_xA4_xBA_xE4_xBE_x8B_xE7_xA8_x8B_xE5_xBA_x8F_xE6_xA6_x82_xE8_xA7_x88.html"><span>Samples</span></a></li>
      <li><a href="_xE5_xB8_xB8_xE8_xA7_x81_xE9_x97_xAE_xE9_xA2_x98.html"><span>FAQs</span></a></li>
      <li><a href="_xE6_xB3_x95_xE5_xBE_x8B_xE5_xA3_xB0_xE6_x98_x8E.html"><span>Disclaimer</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="PageDoc"><div class="contents">
<div class="textblock"><div class="header" style="margin-left:-12px;margin-top:-10px;margin-right:-8px;"> <div class="headertitle"> <div class="title">Image Acquisition</div> </div> </div> <div id="shortdesc"> <br />
 </div><div id="shortdesc">The SDK supports the following 2 image acquisition methods: callback and polling. Select one as needed.</div><div id="shortdesc"> <ul>
<li>
<a href="#callback">Callback</a>: Acquire images via callback. </li>
<li>
<a href="#sequencer">Polling</a>: Acquire images via polling. </li>
</ul>
<dl class="section attention"><dt>Attention</dt><dd>These two methods cannot be used at the same time.</dd></dl>
<br />
 </div><div> <div id="callback"> <div class="mainparams"> <h2>Acquire Images via Callback</h2>
</div></div></div><div><div id="callback"><div class="mainparams"> </div> <div class="subparamswhite"> </div></div></div><div><div id="callback"><div class="subparamswhite">You can register an image callback via calling <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE9_x87_x87_xE9_x9B_x86.html#ga367fa35568b2bb6a22c98354c32ff3c7" title="Registers an image data callback (extended API 1).">MV_CC_RegisterImageCallBackEx()</a>. After getting images, SDK will call the custom callback function.</div></div></div><div><div id="callback"><div class="subparamswhite"> <dl class="section attention"><dt>Attention</dt><dd><ul>
<li>
Time-consuming operations and thread locks are not recommended, because adding them may block the callback. </li>
<li>
pData is invalid and cannot be used again after callback ends. </li>
</ul>
</dd></dl>
</div></div></div><div><div id="callback"><div class="subparamswhite">The API calling flow is as follows:</div></div></div><div><div id="callback"><div class="subparamswhite"> <ol>
<li>
Call <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE9_x87_x87_xE9_x9B_x86.html#ga2088ec54d617eb629412729e0241067d" title="Sets the number of nodes for SDK internal image buffer. The value is no less than 1,...">MV_CC_SetImageNodeNum()</a> to set the appropriate number of buffer nodes. <dl class="section note"><dt>Note</dt><dd>Set the appropriate number of buffer nodes as needed. Major factors include: camera frame rate, image solution, and computer configuration such as main board performance and memory.</dd></dl>
</li>
<li>
Call <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE9_x87_x87_xE9_x9B_x86.html#ga367fa35568b2bb6a22c98354c32ff3c7" title="Registers an image data callback (extended API 1).">MV_CC_RegisterImageCallBackEx()</a> to register an image processing function. </li>
<li>
Call <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE9_x87_x87_xE9_x9B_x86.html#ga78728211c47c6f118110fde635d6ac69" title="Starts image grabbing.">MV_CC_StartGrabbing()</a> to start acquiring images. </li>
<li>
After receiving the images, SDK will process images via the custom image processing function. </li>
</ol>
</div></div></div><div><div id="callback"><div class="subparamswhite">The following sample codes show how to acquire images via callback: <ul>
<li>
<p class="startli"></p>
<p class="interli">Customize the callback function.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> __stdcall <a class="code" href="_parametrize_camera___area_scan_i_o_settings_8cpp.html#add28194d9a3e7dd740ddc738f06c5356">ImageCallBackEx</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> * pData, <a class="code" href="struct_m_v___f_r_a_m_e___o_u_t___i_n_f_o___e_x.html">MV_FRAME_OUT_INFO_EX</a>* pFrameInfo, <span class="keywordtype">void</span>* pUser)</div><div class="line">{</div><div class="line">    <span class="keywordflow">if</span> (pFrameInfo)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;Get One Frame: Width[%d], Height[%d], FrameLen[%I64d] nFrameNum[%d]\n&quot;</span>, </div><div class="line">        pFrameInfo-&gt;<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t___i_n_f_o___e_x.html#ad8e3c34af41bf74a4628b8a456b37a77">nExtendWidth</a>, pFrameInfo-&gt;<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t___i_n_f_o___e_x.html#a7b663309abd055da59e6e496b1092985">nExtendHeight</a>, pFrameInfo-&gt;<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t___i_n_f_o___e_x.html#a733999b9d4f3d252eb79df06f517b410">nFrameLenEx</a>,pFrameInfo-&gt;<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t___i_n_f_o___e_x.html#a6f8d00948b2d76ac8cd65fda0acc2ed6">nFrameNum</a>);</div><div class="line">        <span class="comment">// pData: an image pointer; pFrameInfo-&gt;nFrameLenEx: image length that can be processed</span></div><div class="line">    }</div><div class="line">}</div></div><!-- fragment -->  </li>
<li>
<p class="startli"></p>
<p class="interli">Register a callback for image grabbing and start acquiring images.</p>
<div class="fragment"><div class="line"><span class="comment">// Register a callback for image grabbing</span></div><div class="line">nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE9_x87_x87_xE9_x9B_x86.html#ga367fa35568b2bb6a22c98354c32ff3c7">MV_CC_RegisterImageCallBackEx</a>(<a class="code" href="_image_save_8cpp.html#a81011b79683fab64ce3aff71114f8fdd">handle</a>, <a class="code" href="_parametrize_camera___area_scan_i_o_settings_8cpp.html#add28194d9a3e7dd740ddc738f06c5356">ImageCallBackEx</a>, <a class="code" href="_image_save_8cpp.html#a81011b79683fab64ce3aff71114f8fdd">handle</a>);</div><div class="line">Check(nRet);</div><div class="line"></div><div class="line"><span class="comment">// Set the number of buffer nodes</span></div><div class="line">nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE9_x87_x87_xE9_x9B_x86.html#ga2088ec54d617eb629412729e0241067d">MV_CC_SetImageNodeNum</a>(<a class="code" href="_image_save_8cpp.html#a81011b79683fab64ce3aff71114f8fdd">handle</a>, 5);</div><div class="line">Check(nRet);</div><div class="line"></div><div class="line"><span class="comment">// Start grabbing images</span></div><div class="line">nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE9_x87_x87_xE9_x9B_x86.html#ga78728211c47c6f118110fde635d6ac69">MV_CC_StartGrabbing</a>(<a class="code" href="_image_save_8cpp.html#a81011b79683fab64ce3aff71114f8fdd">handle</a>);</div><div class="line">Check(nRet);</div></div><!-- fragment -->  </li>
</ul>
</div></div></div><div><div id="callback"><div class="subparamswhite"> </div> </div> <div id="sequencer"> <div class="mainparams"> <h2>Acquire Images via Polling</h2>
</div></div></div><div><div id="sequencer"><div class="mainparams"> </div> <div class="subparamswhite"> </div></div></div><div><div id="sequencer"><div class="subparamswhite">You can create a thread and get images via polling in the thread.</div></div></div><div><div id="sequencer"><div class="subparamswhite"> </div></div></div><div><div id="sequencer"><div class="subparamswhite">The API calling flow is as follows:</div></div></div><div><div id="sequencer"><div class="subparamswhite"> <ol>
<li>
<p class="startli"></p>
<p class="interli">Call <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE9_x87_x87_xE9_x9B_x86.html#ga2088ec54d617eb629412729e0241067d" title="Sets the number of nodes for SDK internal image buffer. The value is no less than 1,...">MV_CC_SetImageNodeNum()</a> to set the appropriate number of buffer nodes in SDK. </p>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>
The SDK receives the image data from the camera and caches it internally for external calls. If the upper layer calls are slow and the number of buffer nodes is limited, the SDK will have insufficient buffer to receive new image data, resulting in frame loss. </li>
<li>
Set the appropriate number of buffer nodes as needed. Major factors include camera frame rate, image solution, and computer configuration such as main board performance and memory. </li>
</ul>
</dd></dl>
</li>
<li>
<p class="startli"></p>
<p class="interli">Call <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE9_x87_x87_xE9_x9B_x86.html#ga78728211c47c6f118110fde635d6ac69" title="Starts image grabbing.">MV_CC_StartGrabbing()</a> to start grabbing images.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"></p>
<p class="interli">Call <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE9_x87_x87_xE9_x9B_x86.html#ga33331585a4e2a64653b74af66157a6d8" title="Gets one frame of image using internal buffer. (This API cannot be used with MV_CC_Display() at the s...">MV_CC_GetImageBuffer()</a> in the application layer to get frame data in the specified pixel format.</p>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>
You can set the timeout duration of this API. SDK waits for returned data before timeout. </li>
<li>
When getting image data, you can configure API calling frequency in the upper application layer according to the camera frame rate. </li>
</ul>
</dd></dl>
</li>
<li>
Process images through buffer operation. </li>
<li>
<p class="startli"></p>
<p class="interli">Call <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE9_x87_x87_xE9_x9B_x86.html#gaeff416b2d35df148fa2e63521d8847d3" title="Releases image buffer. (This API is used to release the image buffer that is no longer used,...">MV_CC_FreeImageBuffer()</a> to release the buffer.</p>
<dl class="section note"><dt>Note</dt><dd>After calling <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE9_x87_x87_xE9_x9B_x86.html#gaeff416b2d35df148fa2e63521d8847d3" title="Releases image buffer. (This API is used to release the image buffer that is no longer used,...">MV_CC_FreeImageBuffer()</a>, buffer will be returned to SDK and be invalid.  </dd></dl>
</li>
</ol>
</div></div></div><div><div id="sequencer"><div class="subparamswhite"> </div></div></div><div><div id="sequencer"><div class="subparamswhite">The following sample codes show how to acquire images via polling:</div></div></div><div><div id="sequencer"><div class="subparamswhite"> <ol>
<li>
<p class="startli"></p>
<p class="interli">Customize the thread function.</p>
<div class="fragment"><div class="line"><span class="keyword">static</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> __stdcall <a class="code" href="_trigger___image_8cpp.html#a9ddb69bea521dbf4778610a07f3d0559">WorkThread</a>(<span class="keywordtype">void</span>* <a class="code" href="_image_save_8cpp.html#a81011b79683fab64ce3aff71114f8fdd">handle</a>)</div><div class="line">{</div><div class="line">    <span class="keywordtype">int</span> nRet = <a class="code" href="group___xE6_xAD_xA3_xE7_xA1_xAE_xE7_xA0_x81.html#gacc4f15d534603b339f751d8b2d569305">MV_OK</a>;</div><div class="line">    <a class="code" href="struct_m_v___f_r_a_m_e___o_u_t.html">MV_FRAME_OUT</a> stOutFrame = {0};</div><div class="line">    <span class="keywordflow">while</span>(<span class="keyword">true</span>)</div><div class="line">    {</div><div class="line">        nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE9_x87_x87_xE9_x9B_x86.html#ga33331585a4e2a64653b74af66157a6d8">MV_CC_GetImageBuffer</a>(<a class="code" href="_image_save_8cpp.html#a81011b79683fab64ce3aff71114f8fdd">handle</a>, &amp;stOutFrame, 1000);</div><div class="line">        <span class="keywordflow">if</span> (nRet == <a class="code" href="group___xE6_xAD_xA3_xE7_xA1_xAE_xE7_xA0_x81.html#gacc4f15d534603b339f751d8b2d569305">MV_OK</a>)</div><div class="line">        {</div><div class="line">            printf(<span class="stringliteral">&quot;Get Image Buffer: Width[%d], Height[%d], FrameNum[%d]\n&quot;</span>,</div><div class="line">            stOutFrame.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t.html#a2587481f4ebfe4e2dcc78f073978772a">stFrameInfo</a>.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t___i_n_f_o___e_x.html#a523c75b72da2a3bb32b97032f86c4703">nWidth</a>, stOutFrame.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t.html#a2587481f4ebfe4e2dcc78f073978772a">stFrameInfo</a>.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t___i_n_f_o___e_x.html#a33071a62b54a3c9a671a0fcbe4804f1a">nHeight</a>, stOutFrame.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t.html#a2587481f4ebfe4e2dcc78f073978772a">stFrameInfo</a>.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t___i_n_f_o___e_x.html#a6f8d00948b2d76ac8cd65fda0acc2ed6">nFrameNum</a>);</div><div class="line">            nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE9_x87_x87_xE9_x9B_x86.html#gaeff416b2d35df148fa2e63521d8847d3">MV_CC_FreeImageBuffer</a>(<a class="code" href="_image_save_8cpp.html#a81011b79683fab64ce3aff71114f8fdd">handle</a>, &amp;stOutFrame);</div><div class="line">            Check(nRet);</div><div class="line"></div><div class="line">        }</div><div class="line">        <span class="keywordflow">if</span>(<a class="code" href="_parametrize_camera___area_scan_i_o_settings_8cpp.html#ac5583242746ce08c488e7ae6c71fbfb3">g_bExit</a>)</div><div class="line">        {</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line">    }</div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment -->  </li>
<li>
<p class="startli"></p>
<p class="interli">Start grabbing images.</p>
<div class="fragment"><div class="line"><span class="comment">// Set the number of buffer nodes</span></div><div class="line">nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE9_x87_x87_xE9_x9B_x86.html#ga2088ec54d617eb629412729e0241067d">MV_CC_SetImageNodeNum</a>(<a class="code" href="_image_save_8cpp.html#a81011b79683fab64ce3aff71114f8fdd">handle</a>, 5);</div><div class="line">Check(nRet);</div><div class="line"></div><div class="line"><span class="comment">// Start grabbing images</span></div><div class="line">nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE9_x87_x87_xE9_x9B_x86.html#ga78728211c47c6f118110fde635d6ac69">MV_CC_StartGrabbing</a>(<a class="code" href="_image_save_8cpp.html#a81011b79683fab64ce3aff71114f8fdd">handle</a>);</div><div class="line">Check(nRet);</div><div class="line"></div><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nThreadID = 0;</div><div class="line"><span class="keywordtype">void</span>* hThreadHandle = (<span class="keywordtype">void</span>*) _beginthreadex(NULL , 0 , <a class="code" href="_trigger___image_8cpp.html#a9ddb69bea521dbf4778610a07f3d0559">WorkThread</a> , <a class="code" href="_image_save_8cpp.html#a81011b79683fab64ce3aff71114f8fdd">handle</a>, 0 , &amp;nThreadID );</div><div class="line"><span class="keywordflow">if</span> (NULL == hThreadHandle)</div><div class="line">{</div><div class="line">    <span class="keywordflow">break</span>;</div><div class="line">}</div></div><!-- fragment -->  </li>
</ol>
</div></div></div><div><div id="sequencer"><div class="subparamswhite"> </div> </div></div><div> <div> <br />
 <br />
 <br />
 <table width="60%">
<tr>
<td>Previous: <a class="el" href="_xE4_xBA_x8B_xE4_xBB_xB6_xE5_x8F_x8A_xE5_xBC_x82_xE5_xB8_xB8.html">Event and Exception</a> </td><td>Next: <a class="el" href="_xE5_xA4_x84_xE7_x90_x86_xE5_x9B_xBE_xE5_x83_x8F.html">Image Processing</a>  </td></tr>
</table>
</div> </div> </div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<div class="footer" style="text-align: right;">
	<hr/>
	<small></small>
</div>
<script>
	// 当前选中的菜单
	var currentMenuItem = document.querySelector('.tablist > li.current > a')
	if (currentMenuItem) { // 子菜单情况
	  window.parent.postMessage({
		navHref: currentMenuItem.href
	  }, '*')
	} else {
	  window.parent.postMessage({
		url: window.location.href
	  }, '*')
	}
  </script>
</body>
</html>