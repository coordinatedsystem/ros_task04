<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="custom-style.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
	<div style="overflow: hidden;">
		<div style="height: 57px;min-width: 1039px;background-size: auto 100%;background:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABwgAAAABCAYAAADKO/rAAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABRSURBVFhH7dUxCoBADEXB5LK5/w1iIaLIrsgWNs50Sf/4WVUd8HOZGd1nCqMbGNMPrNMPrJv1cvz0A3OjfuwPvDPrxf7A7t7IlX7gmX74VsQGguw4S6+UnSYAAAAASUVORK5CYII=');">
			<img src="titleleft.png" style="float: left;"/>
			<img src="titleright.png" alt="" style="float: right;" />
		</div>
	</div>
<!-- 制作者 Doxygen 1.8.15 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>首页</span></a></li>
      <li><a href="_xE5_x8F_x91_xE7_x89_x88_xE8_xAF_xB4_xE6_x98_x8E.html"><span>发版说明</span></a></li>
      <li><a href="_xE7_x8E_xAF_xE5_xA2_x83_xE9_x85_x8D_xE7_xBD_xAE.html"><span>环境配置</span></a></li>
      <li><a href="_xE7_xBC_x96_xE7_xA8_x8B_xE5_xBC_x95_xE5_xAF_xBC.html"><span>编程引导</span></a></li>
      <li><a href="modules.html"><span>API参考</span></a></li>
      <li><a href="_xE7_x9B_xB8_xE6_x9C_xBA_xE5_x8F_x82_xE6_x95_xB0_xE8_x8A_x82_xE7_x82_xB9_xE8_xA1_xA8.html"><span>相机参数节点表</span></a></li>
      <li><a href="_xE7_xA4_xBA_xE4_xBE_x8B_xE7_xA8_x8B_xE5_xBA_x8F_xE6_xA6_x82_xE8_xA7_x88.html"><span>示例程序概览</span></a></li>
      <li><a href="_xE5_xB8_xB8_xE8_xA7_x81_xE9_x97_xAE_xE9_xA2_x98.html"><span>常见问题</span></a></li>
      <li><a href="_xE6_xB3_x95_xE5_xBE_x8B_xE5_xA3_xB0_xE6_x98_x8E.html"><span>法律声明</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="PageDoc"><div class="contents">
<div class="textblock"><div class="header" style="margin-left:-12px;margin-top:-10px;margin-right:-8px;"> <div class="headertitle"> <div class="title">处理图像</div> </div> </div> <div id="shortdesc"> <br />
 </div><div id="shortdesc">SDK提供了丰富的图像处理接口，可用于实现图像显示、图像保存、像素格式转换、图像重组和录像等功能。采集到图像后，您可以直接其传入到这些接口中进行图像处理。</div><div id="shortdesc"> <br />
 </div><div id="shortdesc">本节内容包含：</div><div id="shortdesc"> <ul>
<li>
<a href="#render">图像渲染</a> </li>
<li>
<a href="#save">保存图像</a> </li>
<li>
<a href="#pixelFormat">像素格式转换</a> </li>
<li>
<a href="#decode">解码图像</a> </li>
<li>
<a href="#record">录像</a> </li>
<li>
<a href="#reconstruct">分时曝光拆图</a> </li>
</ul>
</div><div> <div id="render"> <div class="mainparams"> <h2>图像渲染</h2>
</div></div></div><div><div id="render"><div class="mainparams"> </div> <div class="subparamswhite"> </div></div></div><div><div id="render"><div class="subparamswhite">采集到图像后，您可参照如下示例，调用 <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE6_xB8_xB2_xE6_x9F_x93.html#ga5f44d5b3c0280e0030c6af1f40542e9a" title="显示一帧图像（扩展接口2）">MV_CC_DisplayOneFrameEx2()</a> 将图像显示在指定窗口。</div></div></div><div><div id="render"><div class="subparamswhite"> <div class="fragment"><div class="line"><span class="comment">// 1. 获取图像相关数据</span></div><div class="line"><a class="code" href="struct_m_v___c_c___i_m_a_g_e.html">MV_CC_IMAGE</a>  stImage = {0};</div><div class="line">stImage.<a class="code" href="struct_m_v___c_c___i_m_a_g_e.html#abbc1b35442c6143931edc0189a3432fb">nWidth</a> = stImageInfo.stFrameInfo.nExtendWidth;</div><div class="line">stImage.<a class="code" href="struct_m_v___c_c___i_m_a_g_e.html#a2e4c6b811457a16b7033af6741cfb1db">nHeight</a> = stImageInfo.stFrameInfo.nExtendHeight;</div><div class="line">stImage.<a class="code" href="struct_m_v___c_c___i_m_a_g_e.html#adea006ae805402cd96d9f8548235da30">enPixelType</a> = stImageInfo.stFrameInfo.enPixelType;</div><div class="line">stImage.<a class="code" href="struct_m_v___c_c___i_m_a_g_e.html#a0d04695d82775f55e4d7ed51c8c983e2">pImageBuf</a> = stImageInfo.pBufAddr;</div><div class="line">stImage.nImageBufLen = stImageInfo.stFrameInfo.nFrameLenEx;</div><div class="line"></div><div class="line"><span class="comment">// 2. 设置渲染模式                </span></div><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> enRenderMode = 0;</div><div class="line"></div><div class="line"><span class="comment">// 3. 显示图像</span></div><div class="line">nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE6_xB8_xB2_xE6_x9F_x93.html#ga5f44d5b3c0280e0030c6af1f40542e9a">MV_CC_DisplayOneFrameEx2</a>(<a class="code" href="_image_save_8cpp.html#a81011b79683fab64ce3aff71114f8fdd">handle</a>,(<span class="keywordtype">void</span>*)<a class="code" href="_display_8cpp.html#a68ffabe952f8abc95b32591b09ca0095">g_hwnd</a>, &amp;stImage , enRenderMode);</div><div class="line">Check(nRet);</div></div><!-- fragment --> <ol>
<li>
获取图像宽、高、像素格式、图像缓存及图像长度。 </li>
<li>
设置图像渲染模式。此处设置为0，表示默认模式，即通过OpenGL模式渲染。 </li>
<li>
通过 <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE6_xB8_xB2_xE6_x9F_x93.html#ga5f44d5b3c0280e0030c6af1f40542e9a" title="显示一帧图像（扩展接口2）">MV_CC_DisplayOneFrameEx2()</a> ，将获取的图像通过指定模式渲染。 </li>
</ol>
</div><p> <br />
 </div> <div id="save"> <div class="mainparams"> <h2>保存图像</h2>
</div></div></div><div><div id="save"><div class="mainparams"> </div> <div class="subparamswhite"> </div></div></div><div><div id="save"><div class="subparamswhite">在采集到图像后，您可将图像保存至本地或内存中：</div></div></div><div><div id="save"><div class="subparamswhite"> <ul>
<li>
保存至本地：调用 <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html#gae035e7dfab861d4d47b76710dacc429c" title="保存图像到文件（扩展接口2）">MV_CC_SaveImageToFileEx2()</a> 。 </li>
<li>
保存至内存：调用 <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html#gaf2f458d195ec3b6688cc0e51472e482c" title="保存图片，支持Bmp和Jpeg">MV_CC_SaveImageEx3()</a> 。 </li>
</ul>
</div></div></div><div><div id="save"><div class="subparamswhite">如下示例代码演示了如何将图像保存成本地BMP文件。</div></div></div><div><div id="save"><div class="subparamswhite"> <div class="fragment"><div class="line"><span class="comment">// 存原始数据bmp图片</span></div><div class="line"><span class="keywordtype">char</span> chImageName[<a class="code" href="_high_bandwidth_decode_8cpp.html#a425361ed80a4a0248d1ed078d9c5bd1f">IMAGE_NAME_LEN</a>] = { 0 };</div><div class="line"><a class="code" href="struct_m_v___c_c___i_m_a_g_e.html">MV_CC_IMAGE</a> stImage;</div><div class="line">memset(&amp;stImage, 0, <span class="keyword">sizeof</span>(<a class="code" href="struct_m_v___c_c___i_m_a_g_e.html">MV_CC_IMAGE</a>));</div><div class="line"><a class="code" href="struct_m_v___c_c___s_a_v_e___i_m_a_g_e___p_a_r_a_m.html">MV_CC_SAVE_IMAGE_PARAM</a> stSaveImageParam;</div><div class="line">memset(&amp;stSaveImageParam, 0, <span class="keyword">sizeof</span>(<a class="code" href="struct_m_v___c_c___s_a_v_e___i_m_a_g_e___p_a_r_a_m.html">MV_CC_SAVE_IMAGE_PARAM</a>));</div><div class="line">stImage.<a class="code" href="struct_m_v___c_c___i_m_a_g_e.html#adea006ae805402cd96d9f8548235da30">enPixelType</a> = stImageInfo.stFrameInfo.enPixelType;</div><div class="line">stImage.<a class="code" href="struct_m_v___c_c___i_m_a_g_e.html#a2e4c6b811457a16b7033af6741cfb1db">nHeight</a> = stImageInfo.stFrameInfo.nExtendWidth;</div><div class="line">stImage.<a class="code" href="struct_m_v___c_c___i_m_a_g_e.html#abbc1b35442c6143931edc0189a3432fb">nWidth</a> = stImageInfo.stFrameInfo.nExtendHeight;</div><div class="line">stImage.nImageBufLen = stImageInfo.stFrameInfo.nFrameLenEx;</div><div class="line">stImage.<a class="code" href="struct_m_v___c_c___i_m_a_g_e.html#a0d04695d82775f55e4d7ed51c8c983e2">pImageBuf</a> = stImageInfo.pBufAddr;</div><div class="line">stSaveImageParam.<a class="code" href="struct_m_v___c_c___s_a_v_e___i_m_a_g_e___p_a_r_a_m.html#a9e97c82636424e576989acc7f5b65e48">enImageType</a> = <a class="code" href="group___xE6_x9E_x9A_xE4_xB8_xBE_xE7_xB1_xBB_xE5_x9E_x8B_xE5_xAE_x9A_xE4_xB9_x89.html#gga5435b1ff781839e7fb5d05f1e4d9bb07a5bfe37840beb201a49b7e6b2771afadc">MV_Image_Bmp</a>;</div><div class="line">stSaveImageParam.<a class="code" href="struct_m_v___c_c___s_a_v_e___i_m_a_g_e___p_a_r_a_m.html#a9301aca02e3916d423fde16e4cdd5527">iMethodValue</a> = 1;</div><div class="line">stSaveImageParam.<a class="code" href="struct_m_v___c_c___s_a_v_e___i_m_a_g_e___p_a_r_a_m.html#a921cfd09cc71bb112daaa7ae5a71471c">nQuality</a> = 99;</div><div class="line">sprintf_s(chImageName, <a class="code" href="_high_bandwidth_decode_8cpp.html#a425361ed80a4a0248d1ed078d9c5bd1f">IMAGE_NAME_LEN</a>, <span class="stringliteral">&quot;InPut_w%d_h%d_fn%03d.bmp&quot;</span>, stImage.<a class="code" href="struct_m_v___c_c___i_m_a_g_e.html#abbc1b35442c6143931edc0189a3432fb">nWidth</a>, stImage.<a class="code" href="struct_m_v___c_c___i_m_a_g_e.html#a2e4c6b811457a16b7033af6741cfb1db">nHeight</a>, stImageInfo.stFrameInfo.nFrameNum);</div><div class="line">nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html#gae035e7dfab861d4d47b76710dacc429c">MV_CC_SaveImageToFileEx2</a>(<a class="code" href="_image_save_8cpp.html#a81011b79683fab64ce3aff71114f8fdd">handle</a>, &amp;stImage, &amp;stSaveImageParam, chImageName);</div><div class="line">Check(nRet);</div></div><!-- fragment --> </div><p> <br />
 </div> <div id="pixelFormat"> <div class="mainparams"> <h2>像素格式转换</h2>
</div></div></div><div><div id="pixelFormat"><div class="mainparams"> </div> <div class="subparamswhite"> </div></div></div><div><div id="pixelFormat"><div class="subparamswhite">采集到图像后，您可调用 <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html#ga36d02611e46d9c488cae6d2fe4eff262" title="像素格式转换">MV_CC_ConvertPixelTypeEx()</a> ，将图像转换成其他像素格式。</div></div></div><div><div id="pixelFormat"><div class="subparamswhite"> </div></div></div><div><div id="pixelFormat"><div class="subparamswhite">例如，您可将Bayer格式转换成RGB/BGR格式。在对Bayer格式图像进行插值时，还支持一些算法功能，如平滑滤波、Gamma矫正和CCM矫正等，具体支持的功能，可参考<a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html">图像处理</a> 相关内容。</div></div></div><div><div id="pixelFormat"><div class="subparamswhite"> </div></div></div><div><div id="pixelFormat"><div class="subparamswhite">如下示例代码演示了如何将图像转换成RGB格式。</div></div></div><div><div id="pixelFormat"><div class="subparamswhite"> <div class="fragment"><div class="line"><span class="comment">// 设置插值方法为均衡</span></div><div class="line">nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html#ga83bb7439fb0f17b0805510bf887b017b">MV_CC_SetBayerCvtQuality</a>(<a class="code" href="_image_save_8cpp.html#a81011b79683fab64ce3aff71114f8fdd">handle</a>, 1);</div><div class="line">Check(nRet);</div><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *pConvertData = NULL;</div><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nConvertDataSize = 0;</div><div class="line">nConvertDataSize = stOutFrame.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t.html#a2587481f4ebfe4e2dcc78f073978772a">stFrameInfo</a>.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t___i_n_f_o___e_x.html#ad8e3c34af41bf74a4628b8a456b37a77">nExtendWidth</a> * stOutFrame.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t.html#a2587481f4ebfe4e2dcc78f073978772a">stFrameInfo</a>.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t___i_n_f_o___e_x.html#a7b663309abd055da59e6e496b1092985">nExtendHeight</a>* 3;</div><div class="line">pConvertData = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)malloc(nConvertDataSize);</div><div class="line"><span class="keywordflow">if</span> (NULL == pDataForRGB)</div><div class="line">{</div><div class="line">    printf(<span class="stringliteral">&quot;pConvertData is null\n&quot;</span>);</div><div class="line">    <span class="keywordflow">break</span>;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// 像素格式转换</span></div><div class="line"><a class="code" href="struct_m_v___c_c___p_i_x_e_l___c_o_n_v_e_r_t___p_a_r_a_m___e_x.html">MV_CC_PIXEL_CONVERT_PARAM_EX</a> stConvertParam = {0};</div><div class="line">stConvertParam.<a class="code" href="struct_m_v___c_c___p_i_x_e_l___c_o_n_v_e_r_t___p_a_r_a_m___e_x.html#abbc1b35442c6143931edc0189a3432fb">nWidth</a> = stOutFrame.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t.html#a2587481f4ebfe4e2dcc78f073978772a">stFrameInfo</a>.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t___i_n_f_o___e_x.html#ad8e3c34af41bf74a4628b8a456b37a77">nExtendWidth</a>;</div><div class="line">stConvertParam.<a class="code" href="struct_m_v___c_c___p_i_x_e_l___c_o_n_v_e_r_t___p_a_r_a_m___e_x.html#a2e4c6b811457a16b7033af6741cfb1db">nHeight</a> = stOutFrame.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t.html#a2587481f4ebfe4e2dcc78f073978772a">stFrameInfo</a>.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t___i_n_f_o___e_x.html#a7b663309abd055da59e6e496b1092985">nExtendHeight</a>;</div><div class="line">stConvertParam.<a class="code" href="struct_m_v___c_c___p_i_x_e_l___c_o_n_v_e_r_t___p_a_r_a_m___e_x.html#a05701d86c4ae0bb4955dbb4bfbafebee">pSrcData</a> = stOutFrame.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t.html#ad09dec12abbdf5f6b77c47105e7eaaa9">pBufAddr</a>;</div><div class="line">stConvertParam.<a class="code" href="struct_m_v___c_c___p_i_x_e_l___c_o_n_v_e_r_t___p_a_r_a_m___e_x.html#a788363fe94292a9095c3db98ca86e355">nSrcDataLen</a> = stOutFrame.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t.html#a2587481f4ebfe4e2dcc78f073978772a">stFrameInfo</a>.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t___i_n_f_o___e_x.html#a733999b9d4f3d252eb79df06f517b410">nFrameLenEx</a>;</div><div class="line">stConvertParam.<a class="code" href="struct_m_v___c_c___p_i_x_e_l___c_o_n_v_e_r_t___p_a_r_a_m___e_x.html#a6af584b61c57a08ee93ed39be605ba6f">enSrcPixelType</a> = stOutFrame.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t.html#a2587481f4ebfe4e2dcc78f073978772a">stFrameInfo</a>.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t___i_n_f_o___e_x.html#adea006ae805402cd96d9f8548235da30">enPixelType</a>;</div><div class="line">stConvertParam.<a class="code" href="struct_m_v___c_c___p_i_x_e_l___c_o_n_v_e_r_t___p_a_r_a_m___e_x.html#ab3d423dfc2e4facdbb48671b55e2a419">enDstPixelType</a> = <a class="code" href="group___xE6_x9E_x9A_xE4_xB8_xBE_xE7_xB1_xBB_xE5_x9E_x8B_xE5_xAE_x9A_xE4_xB9_x89.html#gga94f17d82a2c13785d0085217e9204061a4781513f690167d0552c7ec207210fb0">PixelType_Gvsp_RGB8_Packed</a>;</div><div class="line">stConvertParam.<a class="code" href="struct_m_v___c_c___p_i_x_e_l___c_o_n_v_e_r_t___p_a_r_a_m___e_x.html#a5e9f33d08e3321873d38b6cb60cd021b">pDstBuffer</a> = pConvertData ;</div><div class="line">stConvertParam.<a class="code" href="struct_m_v___c_c___p_i_x_e_l___c_o_n_v_e_r_t___p_a_r_a_m___e_x.html#adbd4a5ebaab5cca214c0f7bacee71676">nDstBufferSize</a> = nConvertDataSize ;</div><div class="line">nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html#ga36d02611e46d9c488cae6d2fe4eff262">MV_CC_ConvertPixelTypeEx</a>(<a class="code" href="_image_save_8cpp.html#a81011b79683fab64ce3aff71114f8fdd">handle</a>, &amp;stConvertParam);</div><div class="line">Check(nRet);</div></div><!-- fragment --> </div><p> <br />
 </div> <div id="decode"> <div class="mainparams"> <h2>解码图像</h2>
</div></div></div><div><div id="decode"><div class="mainparams"> </div> <div class="subparamswhite"> </div></div></div><div><div id="decode"><div class="subparamswhite">部分相机支持对图像进行编码压缩，发送压缩的图像，您可以调用 <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html#gaf4afd4daffefd78f3b044f26d6151c33" title="无损解码">MV_CC_HB_Decode()</a> 对图像进行解码。</div></div></div><div><div id="decode"><div class="subparamswhite"> <dl class="section attention"><dt>注意</dt><dd>解码前需要判断输入图像是否完整，如果因为网络等因素导致图像丢失了部分数据包，该接口可能会解码失败。 您可以通过 <a class="el" href="struct_m_v___f_r_a_m_e___o_u_t___i_n_f_o___e_x.html" title="输出帧的信息">MV_FRAME_OUT_INFO_EX</a> 结构体中的nLostPacket（本帧丢包数）字段进行检测，如果nLostPacket大于0，则当前帧有丢包。</dd></dl>
</div></div></div><div><div id="decode"><div class="subparamswhite">如下示例代码演示了如何解码压缩图像。</div></div></div><div><div id="decode"><div class="subparamswhite"> <div class="fragment"><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* pDstBuf = NULL;</div><div class="line"><a class="code" href="struct_m_v___f_r_a_m_e___o_u_t.html">MV_FRAME_OUT</a> stImageInfo = {0};</div><div class="line"><a class="code" href="struct_m_v___c_c___h_b___d_e_c_o_d_e___p_a_r_a_m.html">MV_CC_HB_DECODE_PARAM</a> stDecodeParam = {0};</div><div class="line"></div><div class="line"><span class="comment">// 检测丢包情况</span></div><div class="line"><span class="keywordflow">if</span> (0 == stImageInfo.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t.html#a2587481f4ebfe4e2dcc78f073978772a">stFrameInfo</a>.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t___i_n_f_o___e_x.html#a2dd610e3ddf8fe159344c569abeb3b3c">nLostPacket</a>)</div><div class="line">{</div><div class="line">    <span class="comment">// 无损压缩解码</span></div><div class="line">    stDecodeParam.<a class="code" href="struct_m_v___c_c___h_b___d_e_c_o_d_e___p_a_r_a_m.html#a01cabcdb6eb04d42ea699fc45bf21375">pSrcBuf</a> = stImageInfo.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t.html#ad09dec12abbdf5f6b77c47105e7eaaa9">pBufAddr</a>;</div><div class="line">    stDecodeParam.<a class="code" href="struct_m_v___c_c___h_b___d_e_c_o_d_e___p_a_r_a_m.html#a6860d280bb5b78e359935494d503b469">nSrcLen</a> = stImageInfo.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t.html#a2587481f4ebfe4e2dcc78f073978772a">stFrameInfo</a>.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t___i_n_f_o___e_x.html#ad6d9155e189b8aab2a81609a8b33c6dc">nFrameLen</a>;</div><div class="line">    <span class="keywordflow">if</span> (NULL == pDstBuf)</div><div class="line">    {</div><div class="line">        pDstBuf = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) * (nPayloadSize));</div><div class="line">        <span class="keywordflow">if</span> (NULL == pDstBuf)</div><div class="line">        {</div><div class="line">            printf(<span class="stringliteral">&quot;malloc pDsrData fail!\n&quot;</span>);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line">    }</div><div class="line">    stDecodeParam.<a class="code" href="struct_m_v___c_c___h_b___d_e_c_o_d_e___p_a_r_a_m.html#a1774c62b15df4e2261e1ac46178ebd41">pDstBuf</a> = pDstBuf;</div><div class="line">    stDecodeParam.<a class="code" href="struct_m_v___c_c___h_b___d_e_c_o_d_e___p_a_r_a_m.html#aeb8e45ddda5f6b8657b4cf440e1e6517">nDstBufSize</a> = nPayloadSize;</div><div class="line">    nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html#gaf4afd4daffefd78f3b044f26d6151c33">MV_CC_HB_Decode</a>(<a class="code" href="_image_save_8cpp.html#a81011b79683fab64ce3aff71114f8fdd">handle</a>, &amp;stDecodeParam);</div><div class="line">    Check(nRet);</div><div class="line">}</div><div class="line"><span class="keywordflow">else</span></div><div class="line">{</div><div class="line">    printf(<span class="stringliteral">&quot;Frame [%d] lost packet [%d] \n&quot;</span>,stImageInfo.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t.html#a2587481f4ebfe4e2dcc78f073978772a">stFrameInfo</a>.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t___i_n_f_o___e_x.html#a6f8d00948b2d76ac8cd65fda0acc2ed6">nFrameNum</a>,stImageInfo.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t.html#a2587481f4ebfe4e2dcc78f073978772a">stFrameInfo</a>.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t___i_n_f_o___e_x.html#a2dd610e3ddf8fe159344c569abeb3b3c">nLostPacket</a>)</div><div class="line">}</div></div><!-- fragment --> </div><p> <br />
 </div> <div id="record"> <div class="mainparams"> <h2>录像</h2>
</div></div></div><div><div id="record"><div class="mainparams"> </div> <div class="subparamswhite"> </div></div></div><div><div id="record"><div class="subparamswhite">您可以通过SDK将从相机接收到的图像保存成录像文件，其方法如下：</div></div></div><div><div id="record"><div class="subparamswhite"> <ol>
<li>
调用 <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html#ga5ce379b3cacbdb3cc551d70c69f56da3" title="开始录像">MV_CC_StartRecord()</a> ，开始录像，您需要配置录像的各种参数。 </li>
<li>
调用 <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html#ga7c1b82605f202400154a5e4060357d51" title="输入录像数据">MV_CC_InputOneFrame()</a> ，循环放入图像数据。 </li>
<li>
在完成录像时，调用 <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html#ga77e2e66bd64b230f63c8d1b529c89c15" title="停止录像">MV_CC_StopRecord()</a> ，停止录像。 </li>
</ol>
</div></div></div><div><div id="record"><div class="subparamswhite">如下示例代码演示了如何将图像保存成录像文件。</div></div></div><div><div id="record"><div class="subparamswhite"> <ol>
<li>
<p class="startli"></p>
<p class="interli">开始录像：调用 <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html#ga5ce379b3cacbdb3cc551d70c69f56da3" title="开始录像">MV_CC_StartRecord()</a> 配置录像的参数，需要的参数可以从相机中获取，也可以从图像中获取。以下代码演示了从相机中获取宽、高、像素格式等参数。</p>
<div class="fragment"><div class="line"><a class="code" href="struct_m_v___c_c___r_e_c_o_r_d___p_a_r_a_m.html">MV_CC_RECORD_PARAM</a> stRecordPar;</div><div class="line"><a class="code" href="struct_m_v_c_c___i_n_t_v_a_l_u_e.html">MVCC_INTVALUE</a> stParam = {0};</div><div class="line">nRet = <a class="code" href="group___xE5_xBA_x9F_xE5_xBC_x83_xE6_x8E_xA5_xE5_x8F_xA3.html#ga4c7fc34b34bb73d58076f7973c8ac69f">MV_CC_GetIntValue</a>(<a class="code" href="_image_save_8cpp.html#a81011b79683fab64ce3aff71114f8fdd">handle</a>, <span class="stringliteral">&quot;Width&quot;</span>, &amp;stParam);</div><div class="line">Check(nRet);</div><div class="line">stRecordPar.<a class="code" href="struct_m_v___c_c___r_e_c_o_r_d___p_a_r_a_m.html#a523c75b72da2a3bb32b97032f86c4703">nWidth</a> = stParam.<a class="code" href="struct_m_v_c_c___i_n_t_v_a_l_u_e.html#a83b19189b7bee89a25ea1f31e96e46e5">nCurValue</a>;</div><div class="line"></div><div class="line">nRet = <a class="code" href="group___xE5_xBA_x9F_xE5_xBC_x83_xE6_x8E_xA5_xE5_x8F_xA3.html#ga4c7fc34b34bb73d58076f7973c8ac69f">MV_CC_GetIntValue</a>(<a class="code" href="_image_save_8cpp.html#a81011b79683fab64ce3aff71114f8fdd">handle</a>, <span class="stringliteral">&quot;Height&quot;</span>, &amp;stParam);</div><div class="line">Check(nRet);</div><div class="line">stRecordPar.<a class="code" href="struct_m_v___c_c___r_e_c_o_r_d___p_a_r_a_m.html#a33071a62b54a3c9a671a0fcbe4804f1a">nHeight</a> = stParam.<a class="code" href="struct_m_v_c_c___i_n_t_v_a_l_u_e.html#a83b19189b7bee89a25ea1f31e96e46e5">nCurValue</a>;</div><div class="line"></div><div class="line"><a class="code" href="struct_m_v_c_c___e_n_u_m_v_a_l_u_e.html">MVCC_ENUMVALUE</a> stEnumValue = {0};</div><div class="line">nRet = <a class="code" href="group___xE5_xB1_x9E_xE6_x80_xA7_xE9_x85_x8D_xE7_xBD_xAE.html#ga2daf898feb1afa4bd5de232d85a33780">MV_CC_GetEnumValue</a>(<a class="code" href="_image_save_8cpp.html#a81011b79683fab64ce3aff71114f8fdd">handle</a>, <span class="stringliteral">&quot;PixelFormat&quot;</span>, &amp;stEnumValue);</div><div class="line">Check(nRet);</div><div class="line">stRecordPar.<a class="code" href="struct_m_v___c_c___r_e_c_o_r_d___p_a_r_a_m.html#adea006ae805402cd96d9f8548235da30">enPixelType</a> = <a class="code" href="group___xE6_x9E_x9A_xE4_xB8_xBE_xE7_xB1_xBB_xE5_x9E_x8B_xE5_xAE_x9A_xE4_xB9_x89.html#ga94f17d82a2c13785d0085217e9204061">MvGvspPixelType</a>(stEnumValue.<a class="code" href="struct_m_v_c_c___e_n_u_m_v_a_l_u_e.html#a83b19189b7bee89a25ea1f31e96e46e5">nCurValue</a>);</div><div class="line"></div><div class="line"><a class="code" href="struct_m_v_c_c___f_l_o_a_t_v_a_l_u_e.html">MVCC_FLOATVALUE</a> stFloatValue;</div><div class="line">nRet = <a class="code" href="group___xE5_xB1_x9E_xE6_x80_xA7_xE9_x85_x8D_xE7_xBD_xAE.html#ga480e49d645f1638ce17da841ac72632c">MV_CC_GetFloatValue</a>(<a class="code" href="_image_save_8cpp.html#a81011b79683fab64ce3aff71114f8fdd">handle</a>, <span class="stringliteral">&quot;ResultingFrameRate&quot;</span>, &amp;stFloatValue);</div><div class="line">Check(nRet);</div><div class="line"></div><div class="line">stRecordPar.<a class="code" href="struct_m_v___c_c___r_e_c_o_r_d___p_a_r_a_m.html#a2ca76d943599df56308bf386dab44aa3">fFrameRate</a> = stFloatValue.<a class="code" href="struct_m_v_c_c___f_l_o_a_t_v_a_l_u_e.html#a11e278521f1696dee14451558c04673a">fCurValue</a>;</div><div class="line">stRecordPar.<a class="code" href="struct_m_v___c_c___r_e_c_o_r_d___p_a_r_a_m.html#af06250062037bfc0b602f7335f22e858">nBitRate</a> = 1000;</div><div class="line">stRecordPar.<a class="code" href="struct_m_v___c_c___r_e_c_o_r_d___p_a_r_a_m.html#aa456e2f6d25272bd19b1e3a031573892">enRecordFmtType</a> = <a class="code" href="group___xE6_x9E_x9A_xE4_xB8_xBE_xE7_xB1_xBB_xE5_x9E_x8B_xE5_xAE_x9A_xE4_xB9_x89.html#gga2ca65d6aefb90111421bddafee42b6b1a92f8214d1fc5f2a223a05be40a9bab1b">MV_FormatType_AVI</a>;</div><div class="line">stRecordPar.<a class="code" href="struct_m_v___c_c___r_e_c_o_r_d___p_a_r_a_m.html#a0dbaa617c548ea19e6b24a480f79ae1c">strFilePath</a>= <span class="stringliteral">&quot;./Recording.avi&quot;</span>;</div><div class="line">nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html#ga5ce379b3cacbdb3cc551d70c69f56da3">MV_CC_StartRecord</a>(<a class="code" href="_image_save_8cpp.html#a81011b79683fab64ce3aff71114f8fdd">handle</a>, &amp;stRecordPar);</div><div class="line">Check(nRet);</div></div><!-- fragment -->  </li>
<li>
<p class="startli"></p>
<p class="interli">放入图像到录像中：循环调用 <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html#ga7c1b82605f202400154a5e4060357d51" title="输入录像数据">MV_CC_InputOneFrame()</a>，将从相机获取的图像数据放入录像中。</p>
<div class="fragment"><div class="line"><span class="keyword">static</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> __stdcall <a class="code" href="_trigger___image_8cpp.html#a9ddb69bea521dbf4778610a07f3d0559">WorkThread</a>(<span class="keywordtype">void</span>* <a class="code" href="_image_save_8cpp.html#a81011b79683fab64ce3aff71114f8fdd">handle</a>)</div><div class="line">{</div><div class="line">    <span class="keywordtype">int</span> nRet = <a class="code" href="group___s_d_k_xE5_x86_x85_xE9_x83_xA8_xE8_x87_xAA_xE5_xAE_x9A_xE4_xB9_x89_xE7_x8A_xB6_xE6_x80_x81_xE7_xA0_x81.html#gacc4f15d534603b339f751d8b2d569305">MV_OK</a>;</div><div class="line">    <a class="code" href="struct_m_v___f_r_a_m_e___o_u_t.html">MV_FRAME_OUT</a> stImageInfo = {0};</div><div class="line">    <a class="code" href="struct_m_v___c_c___i_n_p_u_t___f_r_a_m_e___i_n_f_o.html">MV_CC_INPUT_FRAME_INFO</a> stInputFrameInfo = {0};</div><div class="line">    <span class="keywordflow">while</span>(1)</div><div class="line">    {</div><div class="line">        nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE9_x87_x87_xE9_x9B_x86.html#ga33331585a4e2a64653b74af66157a6d8">MV_CC_GetImageBuffer</a>(<a class="code" href="_image_save_8cpp.html#a81011b79683fab64ce3aff71114f8fdd">handle</a>, &amp;stImageInfo, 1000);</div><div class="line">        <span class="keywordflow">if</span> (nRet == <a class="code" href="group___s_d_k_xE5_x86_x85_xE9_x83_xA8_xE8_x87_xAA_xE5_xAE_x9A_xE4_xB9_x89_xE7_x8A_xB6_xE6_x80_x81_xE7_xA0_x81.html#gacc4f15d534603b339f751d8b2d569305">MV_OK</a>)</div><div class="line">        {</div><div class="line">            printf(<span class="stringliteral">&quot;Get Image Buffer: Width[%d], Height[%d], FrameNum[%d]\n&quot;</span>, </div><div class="line">            stImageInfo.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t.html#a2587481f4ebfe4e2dcc78f073978772a">stFrameInfo</a>.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t___i_n_f_o___e_x.html#a523c75b72da2a3bb32b97032f86c4703">nWidth</a>, stImageInfo.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t.html#a2587481f4ebfe4e2dcc78f073978772a">stFrameInfo</a>.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t___i_n_f_o___e_x.html#a33071a62b54a3c9a671a0fcbe4804f1a">nHeight</a>, stImageInfo.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t.html#a2587481f4ebfe4e2dcc78f073978772a">stFrameInfo</a>.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t___i_n_f_o___e_x.html#a6f8d00948b2d76ac8cd65fda0acc2ed6">nFrameNum</a>);</div><div class="line">            stInputFrameInfo.<a class="code" href="struct_m_v___c_c___i_n_p_u_t___f_r_a_m_e___i_n_f_o.html#aaf2599b3eef445bee5a6bd50569435f7">pData</a> = stImageInfo.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t.html#ad09dec12abbdf5f6b77c47105e7eaaa9">pBufAddr</a>;</div><div class="line">            stInputFrameInfo.<a class="code" href="struct_m_v___c_c___i_n_p_u_t___f_r_a_m_e___i_n_f_o.html#a437032205be38dd5298407ae8b4a2b87">nDataLen</a> = stImageInfo.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t.html#a2587481f4ebfe4e2dcc78f073978772a">stFrameInfo</a>.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t___i_n_f_o___e_x.html#ad6d9155e189b8aab2a81609a8b33c6dc">nFrameLen</a>;</div><div class="line">            nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html#ga7c1b82605f202400154a5e4060357d51">MV_CC_InputOneFrame</a>(<a class="code" href="_image_save_8cpp.html#a81011b79683fab64ce3aff71114f8fdd">handle</a>, &amp;stInputFrameInfo);</div><div class="line">            Check(nRet);</div><div class="line">            nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE9_x87_x87_xE9_x9B_x86.html#gaeff416b2d35df148fa2e63521d8847d3">MV_CC_FreeImageBuffer</a>(<a class="code" href="_image_save_8cpp.html#a81011b79683fab64ce3aff71114f8fdd">handle</a>, &amp;stImageInfo);</div><div class="line">            Check(nRet);</div><div class="line">        }</div><div class="line">        <span class="keywordflow">if</span>(<a class="code" href="_parametrize_camera___area_scan_i_o_settings_8cpp.html#ac5583242746ce08c488e7ae6c71fbfb3">g_bExit</a>)</div><div class="line">        {</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line">    }</div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment -->  </li>
<li>
<p class="startli"></p>
<p class="interli">停止录像：调用 <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html#ga77e2e66bd64b230f63c8d1b529c89c15" title="停止录像">MV_CC_StopRecord()</a> ，停止录像。</p>
<div class="fragment"><div class="line">nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html#ga77e2e66bd64b230f63c8d1b529c89c15">MV_CC_StopRecord</a>(<a class="code" href="_image_save_8cpp.html#a81011b79683fab64ce3aff71114f8fdd">handle</a>);</div><div class="line">Check(nRet);</div></div><!-- fragment -->  </li>
</ol>
</div><p> <br />
 </div> <div id="reconstruct"> <div class="mainparams"> <h2>分时曝光拆图</h2>
</div></div></div><div><div id="reconstruct"><div class="mainparams"> </div> <div class="subparamswhite"> <ul>
<li>
<div> <b>SDK拆图</b> </div><div>部分相机支持分时曝光功能，并将分时曝光的整图发送给SDK，应用程序可以调用 <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html#ga572580f794971d54980480eaf62180b7" title="重构图像（用于分时曝光功能）">MV_CC_ReconstructImage()</a> ，拆分分时曝光的整图，输出每个曝光的图像。</div><div> </div><div>通过SDK端分时曝光拆图和重构图像的基本步骤如下：</div><div> <ol>
<li>
调用 <a class="el" href="group___xE5_xB1_x9E_xE6_x80_xA7_xE9_x85_x8D_xE7_xBD_xAE.html#ga2daf898feb1afa4bd5de232d85a33780" title="获取Enum属性值">MV_CC_GetEnumValue()</a> 获取“MultiLightControl”节点的值，即当前相机的曝光数量。 <dl class="section attention"><dt>注意</dt><dd><ul>
<li>
部分相机可能没有“MultiLightControl”节点，此时，您需根据实际曝光数量进行设置。 </li>
<li>
相机配置HB（High Bandwidth）模式下“MultiLightControl”节点的值，需要进行转换才能得到有效的曝光数量。 </li>
</ul>
</dd></dl>
</li>
<li>
若获取的图像为HB图像，调用 <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html#gaf4afd4daffefd78f3b044f26d6151c33" title="无损解码">MV_CC_HB_Decode()</a> ，进行HB解码。 </li>
<li>
调用 <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html#ga572580f794971d54980480eaf62180b7" title="重构图像（用于分时曝光功能）">MV_CC_ReconstructImage()</a> ，重构图像。 </li>
</ol>
</div><div>示例代码如下：</div><div> <div class="fragment"><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> m_nMultiLightNum = 0;  <span class="comment">//获取多组曝光数量</span></div><div class="line"><a class="code" href="struct_m_v_c_c___e_n_u_m_v_a_l_u_e.html">MVCC_ENUMVALUE</a> stEnumValue = {0};</div><div class="line"><span class="keywordtype">int</span> nRet = <a class="code" href="group___xE5_xB1_x9E_xE6_x80_xA7_xE9_x85_x8D_xE7_xBD_xAE.html#ga2daf898feb1afa4bd5de232d85a33780">MV_CC_GetEnumValue</a>(<a class="code" href="_image_save_8cpp.html#a81011b79683fab64ce3aff71114f8fdd">handle</a>, <span class="stringliteral">&quot;MultiLightControl&quot;</span>, &amp;stEnumValue);</div><div class="line">Check(nRet);</div><div class="line"></div><div class="line">m_nMultiLightNum=stEnumValue.<a class="code" href="struct_m_v_c_c___e_n_u_m_v_a_l_u_e.html#a83b19189b7bee89a25ea1f31e96e46e5">nCurValue</a>;</div><div class="line"></div><div class="line">nRet = <a class="code" href="group___xE5_xB1_x9E_xE6_x80_xA7_xE9_x85_x8D_xE7_xBD_xAE.html#ga2daf898feb1afa4bd5de232d85a33780">MV_CC_GetEnumValue</a>(<a class="code" href="_image_save_8cpp.html#a81011b79683fab64ce3aff71114f8fdd">handle</a>, <span class="stringliteral">&quot;ImageCompressionMode&quot;</span>, &amp;stEnumValue);</div><div class="line">Check(nRet);</div><div class="line"><span class="keywordflow">if</span>(2 == stEnumValue.<a class="code" href="struct_m_v_c_c___e_n_u_m_v_a_l_u_e.html#a83b19189b7bee89a25ea1f31e96e46e5">nCurValue</a>) <span class="comment">//HB开启</span></div><div class="line">{</div><div class="line">    <span class="comment">/*HB模式下，曝光数转换逻辑：</span></div><div class="line"><span class="comment">    目前固件端HB定义的灯数是从0x10起始的，实际灯数从字节低四位获取*/</span></div><div class="line">    m_nMultiLightNum = m_nMultiLightNum &amp; 0xF;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">/*HB模式下，需要对HB图像进行解码后，参考&quot;解码图像&quot;章节，</span></div><div class="line"><span class="comment">    之后再进行重构*/</span></div><div class="line">}</div><div class="line"><a class="code" href="struct_m_v___r_e_c_o_n_s_t_r_u_c_t___i_m_a_g_e___p_a_r_a_m.html">MV_RECONSTRUCT_IMAGE_PARAM</a> stImgReconstructionParam ;</div><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* pImageBufferList[8] = {0};</div><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 8; k++)</div><div class="line">{</div><div class="line">    pImageBufferList[k] = NULL;</div><div class="line">}</div><div class="line">stImgReconstructionParam.<a class="code" href="struct_m_v___r_e_c_o_n_s_t_r_u_c_t___i_m_a_g_e___p_a_r_a_m.html#abbc1b35442c6143931edc0189a3432fb">nWidth</a> = stOutFrame.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t.html#a2587481f4ebfe4e2dcc78f073978772a">stFrameInfo</a>.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t___i_n_f_o___e_x.html#a523c75b72da2a3bb32b97032f86c4703">nWidth</a>;</div><div class="line">stImgReconstructionParam.<a class="code" href="struct_m_v___r_e_c_o_n_s_t_r_u_c_t___i_m_a_g_e___p_a_r_a_m.html#a2e4c6b811457a16b7033af6741cfb1db">nHeight</a> = stOutFrame.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t.html#a2587481f4ebfe4e2dcc78f073978772a">stFrameInfo</a>.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t___i_n_f_o___e_x.html#a33071a62b54a3c9a671a0fcbe4804f1a">nHeight</a>;</div><div class="line">stImgReconstructionParam.<a class="code" href="struct_m_v___r_e_c_o_n_s_t_r_u_c_t___i_m_a_g_e___p_a_r_a_m.html#adea006ae805402cd96d9f8548235da30">enPixelType</a> = stOutFrame.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t.html#a2587481f4ebfe4e2dcc78f073978772a">stFrameInfo</a>.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t___i_n_f_o___e_x.html#adea006ae805402cd96d9f8548235da30">enPixelType</a>;</div><div class="line">stImgReconstructionParam.<a class="code" href="struct_m_v___r_e_c_o_n_s_t_r_u_c_t___i_m_a_g_e___p_a_r_a_m.html#a05701d86c4ae0bb4955dbb4bfbafebee">pSrcData</a> = stOutFrame.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t.html#ad09dec12abbdf5f6b77c47105e7eaaa9">pBufAddr</a>;</div><div class="line">stImgReconstructionParam.<a class="code" href="struct_m_v___r_e_c_o_n_s_t_r_u_c_t___i_m_a_g_e___p_a_r_a_m.html#a788363fe94292a9095c3db98ca86e355">nSrcDataLen</a> = stOutFrame.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t.html#a2587481f4ebfe4e2dcc78f073978772a">stFrameInfo</a>.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t___i_n_f_o___e_x.html#ad6d9155e189b8aab2a81609a8b33c6dc">nFrameLen</a>;</div><div class="line"><span class="comment">/*曝光数量*/</span></div><div class="line">stImgReconstructionParam.<a class="code" href="struct_m_v___r_e_c_o_n_s_t_r_u_c_t___i_m_a_g_e___p_a_r_a_m.html#a82f93fbb210b4b784a61ffd998a33b2c">nExposureNum</a> = m_nMultiLightNum;</div><div class="line">stImgReconstructionParam.<a class="code" href="struct_m_v___r_e_c_o_n_s_t_r_u_c_t___i_m_a_g_e___p_a_r_a_m.html#ac9fd399a973a48361484eb6c84fe1050">enReconstructMethod</a> = <a class="code" href="group___xE6_x9E_x9A_xE4_xB8_xBE_xE7_xB1_xBB_xE5_x9E_x8B_xE5_xAE_x9A_xE4_xB9_x89.html#ggaad679b38955d344ab9e8af885398e5c4a2ba835243b2d219af5991afe90f3b7b3">MV_SPLIT_BY_LINE</a>;</div><div class="line"><span class="comment">/*重组后的长度*/</span></div><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>   nImageBufferSize = stImgReconstructionParam.<a class="code" href="struct_m_v___r_e_c_o_n_s_t_r_u_c_t___i_m_a_g_e___p_a_r_a_m.html#a788363fe94292a9095c3db98ca86e355">nSrcDataLen</a> / m_nMultiLightNum;;</div><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; m_nMultiLightNum; i++)</div><div class="line">{</div><div class="line">    <span class="keywordflow">if</span> (pImageBufferList[i])</div><div class="line">    {</div><div class="line">        free(pImageBufferList[i]);</div><div class="line">        pImageBufferList[i] = NULL;</div><div class="line">    }</div><div class="line">    pImageBufferList[i] = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)malloc(nImageBufferSize);</div><div class="line">    <span class="keywordflow">if</span> (NULL != pImageBufferList[i])</div><div class="line">    {</div><div class="line">        stImgReconstructionParam.<a class="code" href="struct_m_v___r_e_c_o_n_s_t_r_u_c_t___i_m_a_g_e___p_a_r_a_m.html#a557c35e0d3ed44b74b8e69030d1ec4f2">stDstBufList</a>[i].<a class="code" href="struct_m_v___o_u_t_p_u_t___i_m_a_g_e___i_n_f_o.html#af6e43bc48dc04d4a324955754d6fd32a">pBuf</a> = pImageBufferList[i];</div><div class="line">        stImgReconstructionParam.<a class="code" href="struct_m_v___r_e_c_o_n_s_t_r_u_c_t___i_m_a_g_e___p_a_r_a_m.html#a557c35e0d3ed44b74b8e69030d1ec4f2">stDstBufList</a>[i].<a class="code" href="struct_m_v___o_u_t_p_u_t___i_m_a_g_e___i_n_f_o.html#a6a217c7e4feb9d762868f834a73a967a">nBufSize</a> = nImageBufferSize;</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">    {</div><div class="line">        <span class="keywordflow">return</span> <a class="code" href="group___s_d_k_xE5_x86_x85_xE9_x83_xA8_xE8_x87_xAA_xE5_xAE_x9A_xE4_xB9_x89_xE7_x8A_xB6_xE6_x80_x81_xE7_xA0_x81.html#ga2636578dc5c2f4b830e78f42c3d168bb">MV_E_RESOURCE</a>;</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line">nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html#ga572580f794971d54980480eaf62180b7">MV_CC_ReconstructImage</a>(<a class="code" href="_image_save_8cpp.html#a81011b79683fab64ce3aff71114f8fdd">handle</a>, &amp;stImgReconstructionParam);</div><div class="line">Check(nRet);</div></div><!-- fragment --></div><div> </div>  </li>
<li>
<div> <b>采集卡端拆图</b> </div><div>在通过采集卡端拆图时，您可通过 <a class="el" href="struct_m_v___f_r_a_m_e___o_u_t___i_n_f_o___e_x.html" title="输出帧的信息">MV_FRAME_OUT_INFO_EX</a> 结构体中的 SubImageList 获取拆图后的子图。示例代码如下。 <dl class="section note"><dt>注解</dt><dd>只有部分型号采集卡支持拆图功能。</dd></dl>
</div><div> <div class="fragment"><div class="line"><a class="code" href="struct_m_v___f_r_a_m_e___o_u_t.html">MV_FRAME_OUT</a> stFrameOut = { 0 };</div><div class="line">    <span class="keywordtype">int</span> nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE9_x87_x87_xE9_x9B_x86.html#ga33331585a4e2a64653b74af66157a6d8">MV_CC_GetImageBuffer</a>(pUser, &amp;stFrameOut, 1000);</div><div class="line">    <span class="keywordflow">if</span> (nRet == <a class="code" href="group___s_d_k_xE5_x86_x85_xE9_x83_xA8_xE8_x87_xAA_xE5_xAE_x9A_xE4_xB9_x89_xE7_x8A_xB6_xE6_x80_x81_xE7_xA0_x81.html#gacc4f15d534603b339f751d8b2d569305">MV_OK</a>)</div><div class="line">    {</div><div class="line">        <span class="keywordflow">if</span> (stFrameOut.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t.html#a2587481f4ebfe4e2dcc78f073978772a">stFrameInfo</a>.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t___i_n_f_o___e_x.html#a6682393ae51d2e540f6454b47eb291a1">nSubImageNum</a> &gt; 0)</div><div class="line">        {</div><div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; stFrameOut.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t.html#a2587481f4ebfe4e2dcc78f073978772a">stFrameInfo</a>.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t___i_n_f_o___e_x.html#a6682393ae51d2e540f6454b47eb291a1">nSubImageNum</a>; ++i)</div><div class="line">            {</div><div class="line">                <a class="code" href="struct_m_v___c_c___i_m_a_g_e.html">MV_CC_IMAGE</a>* pSubImage = &amp;stFrameOut.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t.html#a2587481f4ebfe4e2dcc78f073978772a">stFrameInfo</a>.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t___i_n_f_o___e_x.html#a1e398db970491986cb0ea7e551c09c41">SubImageList</a>.<a class="code" href="struct_m_v___f_r_a_m_e___o_u_t___i_n_f_o___e_x.html#a74d4e294212bf74626cc41504ca63f44">pstSubImage</a>[i];</div><div class="line"></div><div class="line">                printf(<span class="stringliteral">&quot;SubImage buffer[%p], size[%d]\n&quot;</span>, pSubImage-&gt;<a class="code" href="struct_m_v___c_c___i_m_a_g_e.html#a0d04695d82775f55e4d7ed51c8c983e2">pImageBuf</a>, pSubImage-&gt;<a class="code" href="struct_m_v___c_c___i_m_a_g_e.html#a66221b01016cb3c382b9fe843c53b609">nImageLen</a>);</div><div class="line">            }</div><div class="line">        }</div><div class="line"></div><div class="line">        <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE9_x87_x87_xE9_x9B_x86.html#gaeff416b2d35df148fa2e63521d8847d3">MV_CC_FreeImageBuffer</a>(pUser, &amp;stFrameOut);</div><div class="line">    }</div></div><!-- fragment --> </div>    <div> <br />
 <br />
 <br />
 <table width="60%">
<tr>
<td>上一篇： <a class="el" href="_xE9_x87_x87_xE9_x9B_x86_xE5_x9B_xBE_xE5_x83_x8F.html">采集图像</a> </td><td>下一篇：无  </td></tr>
</table>
</div>  </li>
</ul>
</div></div></div></div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<div class="footer" style="text-align: right;">
	<hr/>
	<small></small>
</div>
<script>
	// 当前选中的菜单
	var currentMenuItem = document.querySelector('.tablist > li.current > a')
	if (currentMenuItem) { // 子菜单情况
	  window.parent.postMessage({
		navHref: currentMenuItem.href
	  }, '*')
	} else {
	  window.parent.postMessage({
		url: window.location.href
	  }, '*')
	}
  </script>
</body>
</html>