<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="custom-style.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
	<div style="overflow: hidden;">
		<div style="height: 57px;min-width: 1039px;background-size: auto 100%;background:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABwgAAAABCAYAAADKO/rAAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABRSURBVFhH7dUxCoBADEXB5LK5/w1iIaLIrsgWNs50Sf/4WVUd8HOZGd1nCqMbGNMPrNMPrJv1cvz0A3OjfuwPvDPrxf7A7t7IlX7gmX74VsQGguw4S6+UnSYAAAAASUVORK5CYII=');">
			<img src="titleleft.png" style="float: left;"/>
			<img src="titleright.png" alt="" style="float: right;" />
		</div>
	</div>
<!-- Generated by Doxygen 1.8.15 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home&#160;Page</span></a></li>
      <li><a href="_xE5_x8F_x91_xE7_x89_x88_xE8_xAF_xB4_xE6_x98_x8E.html"><span>Release&#160;Notes</span></a></li>
      <li><a href="usergroup0.html"><span>Programming&#160;Guide</span></a></li>
      <li><a href="modules.html"><span>API&#160;Reference</span></a></li>
      <li><a href="_xE7_xA4_xBA_xE4_xBE_x8B_xE7_xA8_x8B_xE5_xBA_x8F_xE6_xA6_x82_xE8_xA7_x88.html"><span>Samples</span></a></li>
      <li><a href="_xE6_xB3_x95_xE5_xBE_x8B_xE5_xA3_xB0_xE6_x98_x8E.html"><span>Disclaimer</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="PageDoc"><div class="contents">
<div class="textblock"><div class="header" style="margin-left:-12px;margin-top:-10px;margin-right:-8px;"> <div class="headertitle"> <div class="title">Image Acquisition</div> </div> </div> <div> <br />
 </div><div>Acquire image via <a class="el" href="interface_i_stream_grabber.html" title="Includes APIs related to image grabbing.">IStreamGrabber</a> of <a class="el" href="interface_i_device.html" title="Includes general APIs and parameters of device.">IDevice</a>. <a class="el" href="interface_i_stream_grabber.html" title="Includes APIs related to image grabbing.">IStreamGrabber</a> contains the methods of start grabbing, stop grabbing, acquiring image information, and configuring image acquisition related parameters (number of nodes for image buffer, number of acquired valid images, image acquisition strategy, etc.).</div><div> </div><div>The SDK supports the following two image acquisition methods. Select one as needed.</div><div> <ul>
<li>
Acquire images via callback. </li>
<li>
Acquire images via polling. </li>
</ul>
<dl class="section attention"><dt>Attention</dt><dd>These two methods cannot be used at the same time. Select one at one time.</dd></dl>
<div class="mainparams"> <h2 id="回调取图">Acquire Images via Callback</h2>
</div></div><div><div class="mainparams"> </div> <div class="subparamswhite"> </div></div><div><div class="subparamswhite">The SDK provides FrameGrabedEvent (event for acquiring one frame of image), which can be linked with custom event processing function. When the SDK receives the image, the SDK will trigger the linked function automatically.</div></div><div><div class="subparamswhite"> </div></div><div><div class="subparamswhite">The API calling flow is as follows:</div></div><div><div class="subparamswhite"> <ol>
<li>
<p class="startli"></p>
<p class="interli">Refer to <a class="el" href="interface_i_stream_grabber.html#ab46ec16c7096bae8fec2261e27b07074" title="Event of acquiring one frame of image for getting image data.">IStreamGrabber.FrameGrabedEvent</a> to define the event processing function.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"></p>
<p class="interli">Call <a class="el" href="interface_i_stream_grabber.html#a34f0db3e83dd83661f500b305c7bdf93" title="Sets number of nodes for SDK internal image buffer. The value is no less than 1, and this API should ...">IStreamGrabber.SetImageNodeNum()</a> to set the appropriate number of cache nodes.</p>
<dl class="section note"><dt>Note</dt><dd>The actual number of buffer nodes depends on the actual situation (main influencing factors including camera frame rate, image solution, computer disposition such as motherboard performance and memory).</dd></dl>
</li>
<li>
<p class="startli"></p>
<p class="interli">Call <a class="el" href="interface_i_stream_grabber.html#a3a77e754ee97eea5dc9b453aa2294cb1" title="Starts grabbing images.">IStreamGrabber.StartGrabbing()</a> to start grabbing image.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"></p>
<p class="interli">Wait for the event to be triggered and process image in the custom event processing function.</p>
<p class="endli"></p>
</li>
</ol>
</div></div><div><div class="subparamswhite">The following sample code shows the process of acquiring images via this method:</div></div><div><div class="subparamswhite"> <ul>
<li>
<p class="startli"></p>
<p class="interli">Process via custom event</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> FrameGrabedEventHandler(<span class="keywordtype">object</span> sender, <a class="code" href="class_frame_grabbed_event_args.html">FrameGrabbedEventArgs</a> e)</div><div class="line">{</div><div class="line">    Console.WriteLine(<span class="stringliteral">&quot;Get one frame: Width[{0}] , Height[{1}] , FrameNum[{2}]&quot;</span>, e.<a class="code" href="class_frame_grabbed_event_args.html#a3421d4467979ac4af71d1b5937757793">FrameOut</a>.<a class="code" href="interface_i_frame_out.html#a926a2f7f8a8df31b3529d8a6b4e9cf1a">Image</a>.<a class="code" href="interface_i_image.html#ad1d4412942ac2ef39b05340ee4b9fac8">Width</a>, e.<a class="code" href="class_frame_grabbed_event_args.html#a3421d4467979ac4af71d1b5937757793">FrameOut</a>.<a class="code" href="interface_i_frame_out.html#a926a2f7f8a8df31b3529d8a6b4e9cf1a">Image</a>.<a class="code" href="interface_i_image.html#af5b00bd33a696aa1637d4f6fe50722b5">Height</a>, e.<a class="code" href="class_frame_grabbed_event_args.html#a3421d4467979ac4af71d1b5937757793">FrameOut</a>.<a class="code" href="interface_i_frame_out.html#ace9e98635eaaf4d8e4f5a5b42496263c">FrameNum</a>);</div><div class="line">}</div></div><!-- fragment -->  </li>
<li>
<p class="startli"></p>
<p class="interli">Link event and start grabbing</p>
<div class="fragment"><div class="line"><span class="comment">// Set an appropriate number of buffer nodes</span></div><div class="line">device.StreamGrabber.SetImageNodeNum(5);</div><div class="line"></div><div class="line"><span class="comment">// Register a callback</span></div><div class="line">device.StreamGrabber.FrameGrabedEvent += FrameGrabedEventHandler;</div><div class="line"></div><div class="line"><span class="comment">// Start image grabbing</span></div><div class="line">ret = device.StreamGrabber.StartGrabbing();</div><div class="line"><span class="keywordflow">if</span> (ret != <a class="code" href="class_mv_error.html">MvError</a>.<a class="code" href="class_mv_error.html#aae781ef0f6a59940c564cc5bcaac1792">MV_OK</a>)</div><div class="line">{</div><div class="line">    Console.WriteLine(<span class="stringliteral">&quot;Start grabbing failed:{0:x8}&quot;</span>, ret);</div><div class="line">    <span class="keywordflow">return</span>;</div><div class="line">}</div><div class="line"></div><div class="line">Console.WriteLine(<span class="stringliteral">&quot;Press enter to exit&quot;</span>);</div><div class="line">Console.ReadLine();</div></div><!-- fragment -->  </li>
</ul>
</div> <div class="mainparams"> <h2 id="轮询取图">Acquire Images via Polling</h2>
</div></div><div><div class="mainparams"> </div> <div class="subparamswhite"> </div></div><div><div class="subparamswhite">You can manually create a thread, and repeatedly call <a class="el" href="interface_i_stream_grabber.html#ae5f233c30512db03bb4005f5ee867cd7" title="Gets one frame of image.">IStreamGrabber.GetImageBuffer()</a> in the thread to get image information.</div></div><div><div class="subparamswhite"> <dl class="section note"><dt>Note</dt><dd>The image buffer is applied for within the SDK, therefore, calling <a class="el" href="interface_i_stream_grabber.html#a502f88a8d1cdca602ebe6431ffcf9cea" title="Releases buffer of image not in use. This API should be used with IStreamGrabber.GetImageBuffer().">IStreamGrabber.FreeImageBuffer()</a> to release the image information after image processing is required.</dd></dl>
<ol>
<li>
<p class="startli"></p>
<p class="interli">Customize the thread function, and receive and process images.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> FrameGrabThread(<span class="keywordtype">object</span> obj)</div><div class="line">{</div><div class="line"><a class="code" href="interface_i_stream_grabber.html">IStreamGrabber</a> streamGrabber = (<a class="code" href="interface_i_stream_grabber.html">IStreamGrabber</a>)obj;</div><div class="line"></div><div class="line">    <span class="keywordflow">while</span>(!_grabThreadExit)</div><div class="line">    {</div><div class="line">        <a class="code" href="interface_i_frame_out.html">IFrameOut</a> frame;</div><div class="line"></div><div class="line">        <span class="comment">// Get one frame of image</span></div><div class="line">        <span class="keywordtype">int</span> ret = streamGrabber.<a class="code" href="interface_i_stream_grabber.html#ae5f233c30512db03bb4005f5ee867cd7">GetImageBuffer</a>(1000, out frame);</div><div class="line">        <span class="keywordflow">if</span> (ret != <a class="code" href="class_mv_error.html">MvError</a>.<a class="code" href="class_mv_error.html#aae781ef0f6a59940c564cc5bcaac1792">MV_OK</a>)</div><div class="line">        {</div><div class="line">            Console.WriteLine(<span class="stringliteral">&quot;Get Image failed:{0:x8}&quot;</span>, ret);</div><div class="line">            <span class="keywordflow">continue</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        Console.WriteLine(<span class="stringliteral">&quot;Get one frame: Width[{0}] , Height[{1}] , FrameNum[{2}]&quot;</span>, frame.Image.Width, frame.Image.Height, frame.FrameNum);</div><div class="line"></div><div class="line">        <span class="comment">//Do some thing</span></div><div class="line"></div><div class="line">        <span class="comment">// Release image buffer</span></div><div class="line">        streamGrabber.<a class="code" href="interface_i_stream_grabber.html#a502f88a8d1cdca602ebe6431ffcf9cea">FreeImageBuffer</a>(frame);</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment -->  </li>
<li>
<p class="startli"></p>
<p class="interli">Start acquiring image.</p>
<div class="fragment"><div class="line"><span class="comment">// Start image grabbing</span></div><div class="line">ret = device.StreamGrabber.StartGrabbing();</div><div class="line"><span class="keywordflow">if</span> (ret != <a class="code" href="class_mv_error.html">MvError</a>.<a class="code" href="class_mv_error.html#aae781ef0f6a59940c564cc5bcaac1792">MV_OK</a>)</div><div class="line">{</div><div class="line">    Console.WriteLine(<span class="stringliteral">&quot;Start grabbing failed:{0:x8}&quot;</span>, ret);</div><div class="line">    <span class="keywordflow">return</span>;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// Start the thread for image grabbing</span></div><div class="line">Thread GrabThread = <span class="keyword">new</span> Thread(FrameGrabThread);</div><div class="line">GrabThread.Start(device.StreamGrabber);</div><div class="line"></div><div class="line">Console.WriteLine(<span class="stringliteral">&quot;Press enter to exit&quot;</span>);</div><div class="line">Console.ReadLine();</div></div><!-- fragment -->  </li>
</ol>
</div> <div class="mainparams"> <h2 id="图像拷贝">Copy Image</h2>
</div></div><div><div class="mainparams"> </div> <div class="subparamswhite"> </div></div><div><div class="subparamswhite">The image buffer is applied for within the SDK, therefore, releasing the image information after image processing is required. For extra time-consuming operations required on the image, you can copy a frame of image and save it to your application data queue.<br />
Call IFrame.Clone() or IFrame.Image.Clone() to deep copy the image.</div></div><div><div class="subparamswhite"> <div class="fragment"><div class="line"><span class="comment">// Clone image data via deep copy</span></div><div class="line"><a class="code" href="interface_i_frame_out.html">IFrameOut</a> frameCopy = (<a class="code" href="interface_i_frame_out.html">IFrameOut</a>)e.<a class="code" href="class_frame_grabbed_event_args.html#a3421d4467979ac4af71d1b5937757793">FrameOut</a>.Clone();</div></div><!-- fragment --> </div> </div> </div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<div class="footer" style="text-align: right;">
	<hr/>
	<small></small>
</div>
</body>
</html>