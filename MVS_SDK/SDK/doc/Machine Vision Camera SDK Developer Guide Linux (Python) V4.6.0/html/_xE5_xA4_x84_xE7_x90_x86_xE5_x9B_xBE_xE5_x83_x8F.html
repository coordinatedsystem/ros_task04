<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="custom-style.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
	<div style="overflow: hidden;">
		<div style="height: 57px;min-width: 1039px;background-size: auto 100%;background:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABwgAAAABCAYAAADKO/rAAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABRSURBVFhH7dUxCoBADEXB5LK5/w1iIaLIrsgWNs50Sf/4WVUd8HOZGd1nCqMbGNMPrNMPrJv1cvz0A3OjfuwPvDPrxf7A7t7IlX7gmX74VsQGguw4S6+UnSYAAAAASUVORK5CYII=');">
			<img src="titleleft.png" style="float: left;"/>
			<img src="titleright.png" alt="" style="float: right;" />
		</div>
	</div>
<!-- Generated by Doxygen 1.8.15 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home&#160;Page</span></a></li>
      <li><a href="_xE5_x8F_x91_xE7_x89_x88_xE8_xAF_xB4_xE6_x98_x8E.html"><span>Release&#160;Notes</span></a></li>
      <li><a href="_xE7_xBC_x96_xE7_xA8_x8B_xE5_xBC_x95_xE5_xAF_xBC.html"><span>Programming&#160;Guide</span></a></li>
      <li><a href="modules.html"><span>API&#160;Reference</span></a></li>
      <li><a href="_xE7_xA4_xBA_xE4_xBE_x8B_xE7_xA8_x8B_xE5_xBA_x8F_xE6_xA6_x82_xE8_xA7_x88.html"><span>Samples</span></a></li>
      <li><a href="_xE5_xB8_xB8_xE8_xA7_x81_xE9_x97_xAE_xE9_xA2_x98.html"><span>FAQs</span></a></li>
      <li><a href="_xE6_xB3_x95_xE5_xBE_x8B_xE5_xA3_xB0_xE6_x98_x8E.html"><span>Disclaimer</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="PageDoc"><div class="contents">
<div class="textblock"><div class="header" style="margin-left:-12px;margin-top:-10px;margin-right:-8px;"> <div class="headertitle"> <div class="title">Image Processing</div> </div> </div> <div id="shortdesc"> <br />
 </div><div id="shortdesc">The SDK provides abundant image processing APIs for displaying image, saving image, converting pixel format, reconstructing image, recording, etc. After images are acquired, they can be passed into these APIs for image processing.</div><div id="shortdesc"> <br />
 </div><div id="shortdesc">This chapter includes:</div><div id="shortdesc"> <ul>
<li>
<a href="#render">Image Rendering</a> </li>
<li>
<a href="#save">Image Saving</a> </li>
<li>
<a href="#pixelFormat">Pixel Format Conversion</a> </li>
<li>
<a href="#decode">Image Decoding</a> </li>
<li>
<a href="#record">Record</a> </li>
<li>
<a href="#reconstruct">Image Splitting via Multi-Light Control</a> </li>
</ul>
</div><div> <div id="render"> <div class="mainparams"> <h2>Image Rendering</h2>
</div></div></div><div><div id="render"><div class="mainparams"> </div> <div class="subparamswhite"> </div></div></div><div><div id="render"><div class="subparamswhite">After acquiring the images, you can refer to the following sample codes and call <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE9_x87_x87_xE9_x9B_x86_xE4_xB8_x8E_xE6_xB8_xB2_xE6_x9F_x93.html#gac04bec4e09806381bb2a25949ca90598" title="Displays one frame of image (extended API 2).">MV_CC_DisplayOneFrameEx2()</a> to display the image on the specified window.</div></div></div><div><div id="render"><div class="subparamswhite"> <div class="fragment"><div class="line">displayimage = MV_CC_IMAGE()</div><div class="line">displayimage.nWidth = stOutFrame.stFrameInfo.nWidth </div><div class="line">displayimage.nHeight =  stOutFrame.stFrameInfo.nHeight </div><div class="line">displayimage.enPixelType =  stOutFrame.stFrameInfo.enPixelType </div><div class="line">displayimage.pImageBuf = stOutFrame.pBufAddr</div><div class="line">displayimage.nImageBuffSize = stOutFrame.stFrameInfo.nFrameLen</div><div class="line">displayimage.nImageLen =    stOutFrame.stFrameInfo.nFrameLen</div><div class="line">ret = cam.MV_CC_DisplayOneFrameEx2(int(hwnd),displayimage, 0)</div><div class="line"><span class="keywordflow">if</span> ret != 0:</div><div class="line">    <span class="keywordflow">print</span> (<span class="stringliteral">&quot;MV_CC_DisplayOneFrameEx2 fail! ret[0x%x]&quot;</span> % ret)</div></div><!-- fragment --> <ol>
<li>
Get width, height, pixel format, buffer and length of the image. </li>
<li>
Configure image rendering mode. Set the mode to 0 (default mode), indicating GDI mode. </li>
<li>
Render acquired image through specified mode by calling <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE9_x87_x87_xE9_x9B_x86_xE4_xB8_x8E_xE6_xB8_xB2_xE6_x9F_x93.html#gac04bec4e09806381bb2a25949ca90598" title="Displays one frame of image (extended API 2).">MV_CC_DisplayOneFrameEx2()</a>. </li>
</ol>
</div><p> <br />
 </div> <div id="save"> <div class="mainparams"> <h2>Image Saving</h2>
</div></div></div><div><div id="save"><div class="mainparams"> </div> <div class="subparamswhite"> </div></div></div><div><div id="save"><div class="subparamswhite">You can save the image to the local or the memory.</div></div></div><div><div id="save"><div class="subparamswhite"> <ul>
<li>
To the local: Call <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html#gaad39773c3e16e5a3c94ff0aad8d17f22" title="Saves images to files.">MV_CC_SaveImageToFileEx2()</a>. </li>
<li>
To the memory: Call <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html#ga66ec7fec9bcb33be5c06c76a0b2a50be" title="Saves images, supporting BMP and JPEG.">MV_CC_SaveImageEx3()</a>. </li>
</ul>
</div></div></div><div><div id="save"><div class="subparamswhite">The following sample code shows how to saves images as local BMP files.</div></div></div><div><div id="save"><div class="subparamswhite"> <div class="fragment"><div class="line"><span class="comment"># Save images in BMP format</span></div><div class="line">c_file_path = file_path.encode(<span class="stringliteral">&#39;ascii&#39;</span>)</div><div class="line">stSaveParam = MV_SAVE_IMAGE_TO_FILE_PARAM_EX()</div><div class="line">stSaveParam.enPixelType = frame_info.stFrameInfo.enPixelType  <span class="comment"># Image pixel format</span></div><div class="line">stSaveParam.nWidth = frame_info.stFrameInfo.nWidth  <span class="comment"># Image width</span></div><div class="line">stSaveParam.nHeight = frame_info.stFrameInfo.nHeight  <span class="comment"># Image height</span></div><div class="line">stSaveParam.nDataLen = frame_info.stFrameInfo.nFrameLen</div><div class="line">stSaveParam.pData = frame_info.pBufAddr</div><div class="line">stSaveParam.enImageType = MV_Image_Bmp  <span class="comment"># Image format for saving</span></div><div class="line">stSaveParam.pcImagePath = create_string_buffer(c_file_path)</div><div class="line">stSaveParam.iMethodValue = 1</div><div class="line">stSaveParam.nQuality = 80  <span class="comment"># JPG: (50,99], invalid in other format</span></div><div class="line">ret = cam.MV_CC_SaveImageToFileEx(stSaveParam)</div></div><!-- fragment --> </div><p> <br />
 </div> <div id="pixelFormat"> <div class="mainparams"> <h2>Pixel Format Conversion</h2>
</div></div></div><div><div id="pixelFormat"><div class="mainparams"> </div> <div class="subparamswhite"> </div></div></div><div><div id="pixelFormat"><div class="subparamswhite">Call <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html#gaa87493ab64f207c8117d8d8a8b6b3b69" title="Converts pixel format.">MV_CC_ConvertPixelTypeEx()</a> to convert image format into another format.</div></div></div><div><div id="pixelFormat"><div class="subparamswhite"> </div></div></div><div><div id="pixelFormat"><div class="subparamswhite">For instance, you can transform Bayer to RGB/BGR. The interpolation to images in Bayer format supports several algorithms such as smoothing filter, Gamma correction, and CCM correction. Refer to details in <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html">Image Processing</a>.</div></div></div><div><div id="pixelFormat"><div class="subparamswhite"> </div></div></div><div><div id="pixelFormat"><div class="subparamswhite">The following sample code shows how to convert images to RGB Format.</div></div></div><div><div id="pixelFormat"><div class="subparamswhite"> <div class="fragment"><div class="line">nRGBSize = stOutFrame.stFrameInfo.nWidth * stOutFrame.stFrameInfo.nHeight * 3</div><div class="line">stConvertParam = MV_CC_PIXEL_CONVERT_PARAM_EX()</div><div class="line">memset(byref(stConvertParam), 0, sizeof(stConvertParam))</div><div class="line">stConvertParam.nWidth = stOutFrame.stFrameInfo.nWidth</div><div class="line">stConvertParam.nHeight = stOutFrame.stFrameInfo.nHeight</div><div class="line">stConvertParam.pSrcData = stOutFrame.pBufAddr</div><div class="line">stConvertParam.nSrcDataLen = stOutFrame.stFrameInfo.nFrameLen</div><div class="line">stConvertParam.enSrcPixelType = stOutFrame.stFrameInfo.enPixelType  </div><div class="line">stConvertParam.enDstPixelType = PixelType_Gvsp_RGB8_Packed</div><div class="line">stConvertParam.pDstBuffer = (c_ubyte * nRGBSize)()</div><div class="line">stConvertParam.nDstBufferSize = nRGBSize</div><div class="line"></div><div class="line">ret = cam.MV_CC_ConvertPixelTypeEx(stConvertParam)</div><div class="line"><span class="keywordflow">if</span> ret != 0:</div><div class="line">    <span class="keywordflow">print</span> (<span class="stringliteral">&quot;convert pixel fail! ret[0x%x]&quot;</span> % ret)</div><div class="line">    sys.exit()</div></div><!-- fragment --> </div><p> <br />
 </div> <div id="decode"> <div class="mainparams"> <h2>Image Decoding</h2>
</div></div></div><div><div id="decode"><div class="mainparams"> </div> <div class="subparamswhite"> </div></div></div><div><div id="decode"><div class="subparamswhite">Some cameras support encoding and compressing images. Users can decode image by calling <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html#gaf610ed1745d1d26cdd8123e7759bebba" title="Decodes lossless compression stream into raw data.">MV_CC_HBDecode()</a>.</div></div></div><div><div id="decode"><div class="subparamswhite"> <dl class="section attention"><dt>Attention</dt><dd>Check if the input image is complete before decoding. If some data packet of image is lost, the API will return the failure message. Check with nLostPacket (the number of packets lost in the current frame) in MV_FRAME_OUT_INFO_EX . If the value of nLostPacket is greater than 0, there is packet loss.</dd></dl>
</div></div></div><div><div id="decode"><div class="subparamswhite">The following sample codes show how to decode compressed image.</div></div></div><div><div id="decode"><div class="subparamswhite"> <div class="fragment"><div class="line"><span class="comment"># Decode parameters</span></div><div class="line">stDecodeParam = MV_CC_HB_DECODE_PARAM()</div><div class="line"></div><div class="line"><span class="comment"># Get the size of the data packet</span></div><div class="line">stParam = MVCC_INTVALUE()</div><div class="line">memset(byref(stParam), 0, sizeof(stParam))</div><div class="line"></div><div class="line">ret = cam.MV_CC_GetIntValue(<span class="stringliteral">&quot;PayloadSize&quot;</span>, stParam)</div><div class="line"><span class="keywordflow">if</span> 0 != ret:</div><div class="line">    print(<span class="stringliteral">&quot;Get PayloadSize fail! ret[0x%x]&quot;</span> % ret)</div><div class="line">    <span class="keywordflow">return</span> ret</div><div class="line">nPayloadSize = stParam.nCurValue</div><div class="line">stDecodeParam.pSrcBuf = frame_info.pBufAddr</div><div class="line">stDecodeParam.nSrcLen = frame_info.stFrameInfo.nFrameLen</div><div class="line">stDecodeParam.pDstBuf = (c_ubyte * nPayloadSize)()</div><div class="line">stDecodeParam.nDstBufSize = nPayloadSize</div><div class="line">ret = cam.MV_CC_HBDecode(stDecodeParam)</div><div class="line"><span class="keywordflow">if</span> ret != 0:</div><div class="line">    print(<span class="stringliteral">&quot;HB Decode fail! ret[0x%x]&quot;</span> % ret)</div><div class="line">    <span class="keywordflow">return</span> ret</div></div><!-- fragment --> </div><p> <br />
 </div> <div id="record"> <div class="mainparams"> <h2>Record</h2>
</div></div></div><div><div id="record"><div class="mainparams"> </div> <div class="subparamswhite"> </div></div></div><div><div id="record"><div class="subparamswhite">You can save the image received by the camera as video file through SDK.</div></div></div><div><div id="record"><div class="subparamswhite"> <ol>
<li>
Call <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html#ga973f9b444e4d098c42f838b045c22dda" title="Starts recording.">MV_CC_StartRecord()</a> to start recording. You need to configure parameters required for recording. </li>
<li>
Call <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html#ga73a62aeda05913907a6836ac11bcc0ba" title="Inputs raw data for recording.">MV_CC_InputOneFrame()</a> to add image data to video files repeatedly. </li>
<li>
Call <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html#ga74b00d1812b07ae7f776bce594066fb4" title="Stops recording.">MV_CC_StopRecord()</a> to stop recording when you finish. </li>
</ol>
</div></div></div><div><div id="record"><div class="subparamswhite">The following sample codes show how to save image as video file.</div></div></div><div><div id="record"><div class="subparamswhite"> <ol>
<li>
<p class="startli"></p>
<p class="interli">Start recording: Call <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html#ga973f9b444e4d098c42f838b045c22dda" title="Starts recording.">MV_CC_StartRecord()</a> to configure parameters that can be acquired via camera or image. The following sample codes show how to get parameters including width, height, and pixel format from camera.</p>
<div class="fragment"><div class="line">stParam =  MVCC_INTVALUE()</div><div class="line">memset(byref(stParam), 0, sizeof(MVCC_INTVALUE))</div><div class="line">stRecordPar = MV_CC_RECORD_PARAM()</div><div class="line">memset(byref(stRecordPar), 0, sizeof(MV_CC_RECORD_PARAM))</div><div class="line"><span class="comment"># Get the width of the image</span></div><div class="line">ret = cam.MV_CC_GetIntValue(<span class="stringliteral">&quot;Width&quot;</span>, stParam)</div><div class="line"><span class="keywordflow">if</span> ret != 0: </div><div class="line">    <span class="keywordflow">print</span> (<span class="stringliteral">&quot;get width fail! nRet [0x%x]&quot;</span> % ret)</div><div class="line">    sys.exit()</div><div class="line">stRecordPar.nWidth = stParam.nCurValue</div><div class="line"></div><div class="line"><span class="comment"># Get the height of the image</span></div><div class="line">ret = cam.MV_CC_GetIntValue(<span class="stringliteral">&quot;Height&quot;</span>, stParam)</div><div class="line"><span class="keywordflow">if</span> ret != 0: </div><div class="line">    <span class="keywordflow">print</span> (<span class="stringliteral">&quot;get height fail! nRet [0x%x]&quot;</span>% ret)</div><div class="line">    sys.exit()</div><div class="line">stRecordPar.nHeight = stParam.nCurValue</div><div class="line"></div><div class="line"><span class="comment"># Get the pixel format of the image</span></div><div class="line">stEnumValue = MVCC_ENUMVALUE()</div><div class="line">memset(byref(stEnumValue), 0 ,sizeof(MVCC_ENUMVALUE))</div><div class="line">ret = cam.MV_CC_GetEnumValue(<span class="stringliteral">&quot;PixelFormat&quot;</span>, stEnumValue)</div><div class="line"><span class="keywordflow">if</span> ret != 0: </div><div class="line">    <span class="keywordflow">print</span> (<span class="stringliteral">&quot;get PixelFormat fail! nRet [0x%x]&quot;</span> % ret)</div><div class="line">    sys.exit()</div><div class="line">stRecordPar.enPixelType = MvGvspPixelType(stEnumValue.nCurValue)</div><div class="line"></div><div class="line"><span class="comment"># Get the frame rate of the image</span></div><div class="line">stFloatValue = MVCC_FLOATVALUE()</div><div class="line">memset(byref(stFloatValue), 0 ,sizeof(MVCC_FLOATVALUE))</div><div class="line">ret = cam.MV_CC_GetFloatValue(<span class="stringliteral">&quot;ResultingFrameRate&quot;</span>, stFloatValue)</div><div class="line"><span class="keywordflow">if</span> ret != 0: </div><div class="line">    <span class="keywordflow">print</span> (<span class="stringliteral">&quot;get ResultingFrameRate value fail! nRet [0x%x]&quot;</span> % ret)</div><div class="line">    sys.exit()</div><div class="line">stRecordPar.fFrameRate = stFloatValue.fCurValue</div><div class="line"></div><div class="line"><span class="comment"># Video structure assignment</span></div><div class="line">stRecordPar.nBitRate = 1000</div><div class="line">stRecordPar.enRecordFmtType = MV_FormatType_AVI</div><div class="line">stRecordPar.strFilePath= <span class="stringliteral">&#39;Recording.avi&#39;</span>.encode(<span class="stringliteral">&#39;ascii&#39;</span>)</div><div class="line"></div><div class="line"><span class="comment"># Start recording</span></div><div class="line">nRet = cam.MV_CC_StartRecord(stRecordPar)</div><div class="line"><span class="keywordflow">if</span> ret != 0: </div><div class="line">    <span class="keywordflow">print</span> (<span class="stringliteral">&quot;Start Record fail! nRet [0x%x]\n&quot;</span>, nRet)</div><div class="line">    sys.exit()</div></div><!-- fragment -->  </li>
<li>
<p class="startli"></p>
<p class="interli">Add image data to video files: Call <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html#ga73a62aeda05913907a6836ac11bcc0ba" title="Inputs raw data for recording.">MV_CC_InputOneFrame()</a> repeatedly to add image data from the camera to video files.</p>
<div class="fragment"><div class="line"><span class="comment"># Customize the thread function</span></div><div class="line"><span class="keyword">def </span><a class="code" href="namespace_connect_spec_camera.html#a7d6fa85fa33561934776205cf7d83b26">work_thread</a>(cam=0, pData=0, nDataSize=0):</div><div class="line">    stOutFrame = MV_FRAME_OUT()  </div><div class="line">    memset(byref(stOutFrame), 0, sizeof(stOutFrame))</div><div class="line"></div><div class="line">    stInputFrameInfo = MV_CC_INPUT_FRAME_INFO()</div><div class="line">    memset(byref(stInputFrameInfo), 0 ,sizeof(MV_CC_INPUT_FRAME_INFO))</div><div class="line">    <span class="keywordflow">while</span> <span class="keyword">True</span>:</div><div class="line">        ret = cam.MV_CC_GetImageBuffer(stOutFrame, 1000)</div><div class="line">        <span class="keywordflow">if</span> <span class="keywordtype">None</span> != stOutFrame.pBufAddr <span class="keywordflow">and</span> 0 == ret:</div><div class="line">            <span class="keywordflow">print</span> (<span class="stringliteral">&quot;get one frame: Width[%d], Height[%d], nFrameNum[%d]&quot;</span>  % (stOutFrame.stFrameInfo.nWidth, stOutFrame.stFrameInfo.nHeight, stOutFrame.stFrameInfo.nFrameNum))</div><div class="line">            stInputFrameInfo.pData = cast(stOutFrame.pBufAddr, POINTER(c_ubyte))</div><div class="line">            stInputFrameInfo.nDataLen = stOutFrame.stFrameInfo.nFrameLen</div><div class="line">            <span class="comment"># Input a frame of data to the video interface</span></div><div class="line">            ret = cam.MV_CC_InputOneFrame(stInputFrameInfo)</div><div class="line">            <span class="keywordflow">if</span> ret != 0:</div><div class="line">                <span class="keywordflow">print</span> (<span class="stringliteral">&quot;input one frame fail! nRet [0x%x]&quot;</span> % ret)</div><div class="line">            nRet = cam.MV_CC_FreeImageBuffer(stOutFrame)</div><div class="line">        <span class="keywordflow">else</span>:</div><div class="line">            <span class="keywordflow">print</span> (<span class="stringliteral">&quot;no data[0x%x]&quot;</span> % ret)</div><div class="line">        <span class="keywordflow">if</span> g_bExit == <span class="keyword">True</span>:</div><div class="line">                <span class="keywordflow">break</span></div></div><!-- fragment -->  </li>
<li>
<p class="startli"></p>
<p class="interli">Stop recording: Call <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html#ga74b00d1812b07ae7f776bce594066fb4" title="Stops recording.">MV_CC_StopRecord()</a> to stop recording.</p>
<div class="fragment"><div class="line"><span class="comment"># Stop recording</span></div><div class="line">ret = cam.MV_CC_StopRecord()</div><div class="line"><span class="keywordflow">if</span> ret != 0:</div><div class="line">    <span class="keywordflow">print</span> (<span class="stringliteral">&quot;stop Record fail! ret[0x%x]&quot;</span> % ret)</div><div class="line">    sys.exit()</div></div><!-- fragment -->  </li>
</ol>
</div><p> <br />
 </div> <div id="reconstruct"> <div class="mainparams"> <h2>Image Splitting via Multi-Light Control</h2>
</div></div></div><div><div id="reconstruct"><div class="mainparams"> </div> <div class="subparamswhite"> <div> <b>Split Image via SDK</b> </div></div></div></div><div><div id="reconstruct"><div class="subparamswhite"><div>Some cameras support multi-light control, and can send the entire multi-light control image to SDK. By calling <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html#gad9aa4cee88e517847211ab01427f7a25" title="Reconstructs the image for multi-light control.">MV_CC_ReconstructImage()</a>, the entire image can be split and each image under exposure can be outputted.</div></div></div></div><div><div id="reconstruct"><div class="subparamswhite"><div> </div></div></div></div><div><div id="reconstruct"><div class="subparamswhite"><div>The basic steps of image division via SDK and image reconstruction are as follows:</div></div></div></div><div><div id="reconstruct"><div class="subparamswhite"><div> <ol>
<li>
Call <a class="el" href="group___xE8_xAE_xBE_xE5_xA4_x87_xE5_xB1_x9E_xE6_x80_xA7.html#gaf90e3d0f751c6b7ec5796715a9cb5326" title="Gets the value of enumeration type node.">MV_CC_GetEnumValue()</a> to get the value of node "MultiLightControl", namely the number of exposures of the current camera. <dl class="section attention"><dt>Attention</dt><dd><ul>
<li>
Some cameras may lack the node "MultiLightControl", so you need to configure the number of exposures. </li>
<li>
In the HB (high bandwidth) mode, the value of node "MultiLightControl" needs to be converted for effective number of exposures. </li>
</ul>
</dd></dl>
</li>
<li>
If the image acquired is HB image, call <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html#gaf610ed1745d1d26cdd8123e7759bebba" title="Decodes lossless compression stream into raw data.">MV_CC_HBDecode()</a> for HB decoding. </li>
<li>
Call <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86.html#gad9aa4cee88e517847211ab01427f7a25" title="Reconstructs the image for multi-light control.">MV_CC_ReconstructImage()</a> to reconstruct image. </li>
</ol>
</div></div></div></div><div><div id="reconstruct"><div class="subparamswhite"><div>The sample code is as follows:</div></div></div></div><div><div id="reconstruct"><div class="subparamswhite"><div> <div class="fragment"><div class="line"><span class="comment"># Reconstruct image parameters</span></div><div class="line">stReconstructParam = MV_RECONSTRUCT_IMAGE_PARAM()</div><div class="line"></div><div class="line"><span class="comment"># If the image is in HB format, it should be decoded first</span></div><div class="line"><span class="keywordflow">if</span> stOutFrame.stFrameInfo.enPixelType <span class="keywordflow">in</span> HB_format_list:</div><div class="line">    <span class="comment"># Gets the size of the data packet.</span></div><div class="line">    stParam = MVCC_INTVALUE()</div><div class="line">    memset(byref(stParam), 0, sizeof(stParam))</div><div class="line">    ret = cam.MV_CC_GetIntValue(<span class="stringliteral">&quot;PayloadSize&quot;</span>, stParam)</div><div class="line">    <span class="keywordflow">if</span> 0 != ret:</div><div class="line">        <span class="keywordflow">raise</span> Exception(<span class="stringliteral">&quot;Get PayloadSize fail! ret[0x%x]&quot;</span> % ret)</div><div class="line">    nPayloadSize = stParam.nCurValue</div><div class="line">    stDecodeParam.pSrcBuf = stOutFrame.pBufAddr</div><div class="line">    stDecodeParam.nSrcLen = stOutFrame.stFrameInfo.nFrameLen</div><div class="line">    stDecodeParam.pDstBuf = (c_ubyte * nPayloadSize)()</div><div class="line">    stDecodeParam.nDstBufSize = nPayloadSize</div><div class="line">    ret = cam.MV_CC_HBDecode(stDecodeParam)</div><div class="line">    <span class="keywordflow">if</span> ret != 0:</div><div class="line">        <span class="keywordflow">raise</span> Exception(<span class="stringliteral">&quot;HB Decode fail! ret[0x%x]&quot;</span> % ret)</div><div class="line">    <span class="keywordflow">else</span>:</div><div class="line">        stReconstructParam.nWidth = stDecodeParam.nWidth</div><div class="line">        stReconstructParam.nHeight = stDecodeParam.nHeight</div><div class="line">        stReconstructParam.enPixelType = stDecodeParam.enDstPixelType</div><div class="line">        stReconstructParam.pSrcData = stDecodeParam.pDstBuf</div><div class="line">        stReconstructParam.nSrcDataLen = stDecodeParam.nDstBufLen</div><div class="line"><span class="keywordflow">else</span>:</div><div class="line">    stReconstructParam.nWidth = stOutFrame.stFrameInfo.nWidth</div><div class="line">    stReconstructParam.nHeight = stOutFrame.stFrameInfo.nHeight</div><div class="line">    stReconstructParam.enPixelType = stOutFrame.stFrameInfo.enPixelType</div><div class="line">    stReconstructParam.pSrcData = stOutFrame.pBufAddr</div><div class="line">    stReconstructParam.nSrcDataLen = stOutFrame.stFrameInfo.nFrameLen</div><div class="line"></div><div class="line">stReconstructParam.nExposureNum = exposure_num</div><div class="line">stReconstructParam.enReconstructMethod = MV_SPLIT_BY_LINE</div><div class="line"></div><div class="line">dst_buffer_len = int(stReconstructParam.nSrcDataLen/exposure_num)</div><div class="line"><span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(exposure_num):</div><div class="line">    dst_buffer = (c_ubyte * dst_buffer_len)()</div><div class="line">    dst_buffer_list.append(dst_buffer)</div><div class="line">    stReconstructParam.stDstBufList[i].pBuf = dst_buffer_list[i]</div><div class="line">    stReconstructParam.stDstBufList[i].nBufSize = dst_buffer_len</div><div class="line"></div><div class="line"><span class="comment"># Image reconstruction</span></div><div class="line">ret = cam.MV_CC_ReconstructImage(stReconstructParam)</div><div class="line"><span class="keywordflow">if</span> ret != 0:</div><div class="line">    <span class="keywordflow">raise</span> Exception(<span class="stringliteral">&quot;MV_CC_ReconstructImage fail! ret[0x%x]&quot;</span> % ret)</div><div class="line"><span class="keywordflow">else</span>:</div><div class="line">    print(<span class="stringliteral">&quot;Reconstruct image success&quot;</span>)</div></div><!-- fragment --> </div> </div> </div> <div> <br />
 <br />
 <br />
 <table width="60%">
<tr>
<td>Previous: <a class="el" href="_xE9_x87_x87_xE9_x9B_x86_xE5_x9B_xBE_xE5_x83_x8F.html">Image Acquisition</a> </td><td>Next: None  </td></tr>
</table>
</div> </div> </div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<div class="footer" style="text-align: right;">
	<hr/>
	<small></small>
</div>
</body>
</html>