<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="custom-style.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
	<div style="overflow: hidden;">
		<div style="height: 57px;min-width: 1039px;background-size: auto 100%;background:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABwgAAAABCAYAAADKO/rAAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABRSURBVFhH7dUxCoBADEXB5LK5/w1iIaLIrsgWNs50Sf/4WVUd8HOZGd1nCqMbGNMPrNMPrJv1cvz0A3OjfuwPvDPrxf7A7t7IlX7gmX74VsQGguw4S6+UnSYAAAAASUVORK5CYII=');">
			<img src="titleleft.png" style="float: left;"/>
			<img src="titleright.png" alt="" style="float: right;" />
		</div>
	</div>
<!-- 制作者 Doxygen 1.8.15 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>首页</span></a></li>
      <li><a href="_xE5_x8F_x91_xE7_x89_x88_xE8_xAF_xB4_xE6_x98_x8E.html"><span>发版说明</span></a></li>
      <li><a href="_xE7_xBC_x96_xE7_xA8_x8B_xE5_xBC_x95_xE5_xAF_xBC.html"><span>编程引导</span></a></li>
      <li><a href="modules.html"><span>API参考</span></a></li>
      <li><a href="_xE7_xA4_xBA_xE4_xBE_x8B_xE7_xA8_x8B_xE5_xBA_x8F_xE6_xA6_x82_xE8_xA7_x88.html"><span>示例程序概览</span></a></li>
      <li><a href="_xE5_xB8_xB8_xE8_xA7_x81_xE9_x97_xAE_xE9_xA2_x98.html"><span>常见问题</span></a></li>
      <li><a href="_xE6_xB3_x95_xE5_xBE_x8B_xE5_xA3_xB0_xE6_x98_x8E.html"><span>法律声明</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="PageDoc"><div class="contents">
<div class="textblock"><div class="header" style="margin-left:-12px;margin-top:-10px;margin-right:-8px;"> <div class="headertitle"> <div class="title">事件及异常</div> </div> </div> <p>事件可分为正常通知事件和异常告警事件。</p>
<ul>
<li>
<p class="startli"></p>
<p class="interli">正常通知事件指相机或采集卡处于正常状态下出现的事件。根据事件生成条件的差异，让设备上报事件至您的程序的操作有所差异。</p>
<ul>
<li>
<p class="startli"></p>
<p class="interli">部分事件需在相机或连接至采集卡的相机开始取流后才可触发。对于此类事件，您在程序中调用事件相关接口订阅并启用指定事件后，需调用 <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE9_x87_x87_xE9_x9B_x86_xE4_xB8_x8E_xE6_xB8_xB2_xE6_x9F_x93.html#ga379f992aec0ddd3170b0ef0f5f2306d7" title="开始取流">MV_CC_StartGrabbing()</a> 让相机开始取流，从而让设备上报取流相关的事件至您的程序。</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"></p>
<p class="interli">部分事件无需取流即可上报。您可调用事件相关接口订阅并启用指定事件，让设备上报事件至您的程序。</p>
<p class="endli"></p>
</li>
</ul>
</li>
<li>
<p class="startli"></p>
<p class="interli">异常告警事件是在相机、采集卡或者SDK运行时产生的异常事件（例如相机掉线等），此类事件可直接从SDK中获取，可用于及时预警，排除异常情况。 </p>
<p class="interli"></p>
<p class="interli">当相机或者采集卡打开成功后，即可注册自定义的异常告警事件处理函数。注册成功后，当设备产生异常告警时，将自动执行自定义的异常告警处理函数。</p>
<p class="endli"></p>
</li>
</ul>
<div> <div id="eventGrab"> <div class="mainparams"> <h2 id="事件采集">事件采集</h2>
</div></div></div><div><div id="eventGrab"><div class="mainparams"> </div> <div class="subparamswhite"> </div></div></div><div><div id="eventGrab"><div class="subparamswhite">您可以依次通过订阅、启用、获取、关闭和取消订阅正常通知事件，完成事件的处理流程。</div></div></div><div><div id="eventGrab"><div class="subparamswhite"> <dl class="section note"><dt>注解</dt><dd>若要获取正常通知事件，需先通过客户端配置采集卡/相机的 EventControl 属性。 <ul>
<li>
相机配置操作详情参见客户端用户手册。 </li>
<li>
采集卡事件可以通过采集卡事件配置工具进行配置。 </li>
</ul>
</dd></dl>
<ol>
<li>
<p class="startli"></p>
<p class="interli"><b>订阅</b>：可通过调用 <a class="el" href="group___xE4_xBA_x8B_xE4_xBB_xB6_xE5_x8F_x8A_xE5_xBC_x82_xE5_xB8_xB8.html#gacc4517be2f2fe63573f5e2e1169c94aa" title="注册单个事件回调，在打开设备之后调用">MV_CC_RegisterEventCallBackEx()</a> 订阅指定事件。调用该接口时需传入事件名称StrEventName。</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"></p>
<p class="interli"><b>启用</b>：可通过调用 <a class="el" href="group___xE4_xBA_x8B_xE4_xBB_xB6_xE5_x8F_x8A_xE5_xBC_x82_xE5_xB8_xB8.html#gaabaa8187cee0a8e5bb2e78f129f4bf0a" title="开启设备指定事件">MV_CC_EventNotificationOn()</a> 启用指定事件。</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"></p>
<p class="interli"><b>获取</b>：当相机或采集卡生成一个事件时，SDK会触发对应的事件回调函数并将该事件信息推送给用户。一般情况下，推送给用户的事件信息中包含事件名称、事件ID和时间戳等关键信息，其他信息如帧号和事件数据等则不一定包含。不同事件所包含的信息会存在差异，请以实际情况为准。</p>
<dl class="section attention"><dt>注意</dt><dd>请勿通过事件回调函数执行耗时较长的操作，否则将导致后续事件信息的推送被阻塞。<br />
 </dd></dl>
</li>
<li>
<p class="startli"></p>
<p class="interli"><b>关闭</b>：可通过调用 <a class="el" href="group___xE4_xBA_x8B_xE4_xBB_xB6_xE5_x8F_x8A_xE5_xBC_x82_xE5_xB8_xB8.html#ga9e144b38edcfa73b633177c8a18c7a42" title="关闭设备指定事件">MV_CC_EventNotificationOff()</a> 关闭指定事件。</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"></p>
<p class="interli"><b>取消订阅</b>：可通过调用 <a class="el" href="group___xE4_xBA_x8B_xE4_xBB_xB6_xE5_x8F_x8A_xE5_xBC_x82_xE5_xB8_xB8.html#gacc4517be2f2fe63573f5e2e1169c94aa" title="注册单个事件回调，在打开设备之后调用">MV_CC_RegisterEventCallBackEx()</a> 取消订阅指定事件。调用该接口时需传入事件名称strEventName，并将事件回调指针cbEvent设置为NULL。调用成功后，则取消订阅指定事件。</p>
<p class="endli"></p>
</li>
</ol>
</div></div></div><div><div id="eventGrab"><div class="subparamswhite">如下示例代码演示了相机"曝光结束"事件的处理全过程。</div></div></div><div><div id="eventGrab"><div class="subparamswhite"> <div class="fragment"><div class="line">stEventInfo = POINTER(MV_EVENT_OUT_INFO)</div><div class="line">EventInfoCallBack = <a class="code" href="namespace_parametrize_camera___area_scan_i_o_settings.html#a3bae6d695a340d90cc6e249839d03825">winfun_ctype</a>(<span class="keywordtype">None</span>, stEventInfo, c_void_p)</div><div class="line"></div><div class="line"><span class="keyword">def </span><a class="code" href="namespace_events___interface.html#ab59b303fa8bf249d7233b2879322c040">event_callback</a>(pEventInfo, pUser):</div><div class="line">    stPEventInfo = cast(pEventInfo, POINTER(MV_EVENT_OUT_INFO)).contents</div><div class="line">    nBlockId = stPEventInfo.nBlockIdHigh</div><div class="line">    nBlockId = (nBlockId &lt;&lt; 32) + stPEventInfo.nBlockIdLow</div><div class="line">    nTimestamp = stPEventInfo.nTimestampHigh</div><div class="line">    nTimestamp = (nTimestamp &lt;&lt; 32) + stPEventInfo.nTimestampLow</div><div class="line">    <span class="keywordflow">if</span> stPEventInfo:</div><div class="line">        <span class="keywordflow">print</span> (<span class="stringliteral">&quot;EventName[%s], EventId[%u], BlockId[%d], Timestamp[%d]&quot;</span> % (stPEventInfo.EventName.decode(<span class="stringliteral">&#39;UTF-8&#39;</span>),</div><div class="line">                                                                           stPEventInfo.nEventID, nBlockId, nTimestamp))</div><div class="line"></div><div class="line">CALL_BACK_FUN = <a class="code" href="namespace_events___interface.html#aab25803c5c5aa89135648c3caf6b95b6">EventInfoCallBack</a>(event_callback)</div><div class="line"><span class="keywordflow">if</span> __name__ == <span class="stringliteral">&quot;__main__&quot;</span>:</div><div class="line"></div><div class="line">    <span class="comment"># ch:初始化SDK | en: initialize SDK</span></div><div class="line">    MvCamera.MV_CC_Initialize()</div><div class="line"></div><div class="line">    <span class="comment"># ch: 设备枚举，创建示例</span></div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment"># ch:打开设备 | en:Open device</span></div><div class="line">    ret = cam.MV_CC_OpenDevice(MV_ACCESS_Exclusive, 0)</div><div class="line">    <span class="keywordflow">if</span> ret != 0:</div><div class="line">        <span class="keywordflow">print</span> (<span class="stringliteral">&quot;open device fail! ret[0x%x]&quot;</span> % ret)</div><div class="line">        sys.exit()</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment"># ch:开启Event | en:Set Event of ExposureEnd On</span></div><div class="line">    ret = cam.MV_CC_EventNotificationOn(<span class="stringliteral">&quot;ExposureEnd&quot;</span>)</div><div class="line">    <span class="keywordflow">if</span> ret != 0:</div><div class="line">        <span class="keywordflow">print</span> (<span class="stringliteral">&quot;Set Event Notification On fail! ret[0x%x]&quot;</span> % ret)</div><div class="line">        sys.exit()</div><div class="line"></div><div class="line">    <span class="comment"># ch:注册事件回调 | en:Register event callback</span></div><div class="line">    ret = cam.MV_CC_RegisterEventCallBackEx(<span class="stringliteral">&quot;ExposureEnd&quot;</span>, CALL_BACK_FUN,<span class="keywordtype">None</span>)</div><div class="line">    <span class="keywordflow">if</span> ret != 0:</div><div class="line">        <span class="keywordflow">print</span> (<span class="stringliteral">&quot;register event callback fail! ret [0x%x]&quot;</span> % ret)</div><div class="line">        sys.exit()</div><div class="line"></div><div class="line">    <span class="comment"># ch:开始取流 | en:Start grab image</span></div><div class="line">    cam.MV_CC_StartGrabbing()</div><div class="line">    <span class="keywordflow">if</span> ret != 0:</div><div class="line">        <span class="keywordflow">print</span> (<span class="stringliteral">&quot;start grabbing fail! ret[0x%x]&quot;</span> % ret)</div><div class="line">        sys.exit()</div><div class="line"></div><div class="line">    <span class="keywordflow">print</span> (<span class="stringliteral">&quot;press a key to stop grabbing.&quot;</span>)</div><div class="line">    <a class="code" href="namespace_parametrize_camera___area_scan_i_o_settings.html#ada091daac0b443feeefd371689422720">press_any_key_exit</a>()</div><div class="line"></div><div class="line">    <span class="comment"># ch:停止取流 | en:Stop grab image</span></div><div class="line">    ret = cam.MV_CC_StopGrabbing()</div><div class="line">    <span class="keywordflow">if</span> ret != 0:</div><div class="line">        <span class="keywordflow">print</span> (<span class="stringliteral">&quot;stop grabbing fail! ret[0x%x]&quot;</span> % ret)</div><div class="line">        sys.exit()</div><div class="line"></div><div class="line">    <span class="comment"># ch:关闭设备 | Close device</span></div><div class="line">    ret = cam.MV_CC_CloseDevice()</div><div class="line">    <span class="keywordflow">if</span> ret != 0:</div><div class="line">        <span class="keywordflow">print</span> (<span class="stringliteral">&quot;close deivce fail! ret[0x%x]&quot;</span> % ret)</div><div class="line">        sys.exit()</div><div class="line"></div><div class="line">    <span class="comment"># ch:销毁句柄 | Destroy handle</span></div><div class="line">    ret = cam.MV_CC_DestroyHandle()</div><div class="line">    <span class="keywordflow">if</span> ret != 0:</div><div class="line">        <span class="keywordflow">print</span> (<span class="stringliteral">&quot;destroy handle fail! ret[0x%x]&quot;</span> % ret)</div><div class="line">        sys.exit()</div><div class="line"></div><div class="line">    <span class="comment"># ch:反初始化SDK | en: finalize SDK</span></div><div class="line">    MvCamera.MV_CC_Finalize()</div></div><!-- fragment --> <dl class="section note"><dt>注解</dt><dd>枚举设备和创建相机实例步骤的示例代码可参考<a class="el" href="_xE5_x88_x9D_xE5_xA7_x8B_xE5_x8C_x96_xE7_x9B_xB8_xE6_x9C_xBA.html">初始化相机</a> 章节。<br />
</dd></dl>
</div></div></div><div><div id="eventGrab"><div class="subparamswhite">如下示例代码演示了采集卡"帧开始"事件的处理全过程。</div></div></div><div><div id="eventGrab"><div class="subparamswhite"> <div class="fragment"><div class="line"><span class="comment"># ch: 事件回调函数 | en: Event callback function</span></div><div class="line">stEventInfo = POINTER(MV_EVENT_OUT_INFO)</div><div class="line">EventInfoCallBack = <a class="code" href="namespace_parametrize_camera___area_scan_i_o_settings.html#a3bae6d695a340d90cc6e249839d03825">winfun_ctype</a>(<span class="keywordtype">None</span>, stEventInfo, c_void_p)</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">def </span><a class="code" href="namespace_events___interface.html#ab59b303fa8bf249d7233b2879322c040">event_callback</a>(pEventInfo, pUser):</div><div class="line">    stPEventInfo = cast(pEventInfo, POINTER(MV_EVENT_OUT_INFO)).contents</div><div class="line">    nBlockId = stPEventInfo.nBlockIdHigh</div><div class="line">    nBlockId = (nBlockId &lt;&lt; 32) + stPEventInfo.nBlockIdLow</div><div class="line">    nTimestamp = stPEventInfo.nTimestampHigh</div><div class="line">    nTimestamp = (nTimestamp &lt;&lt; 32) + stPEventInfo.nTimestampLow</div><div class="line">    <span class="keywordflow">if</span> stPEventInfo:</div><div class="line">        print(<span class="stringliteral">&quot;EventName[%s], EventId[%u], BlockId[%d], Timestamp[%d]&quot;</span> % (stPEventInfo.EventName.decode(<span class="stringliteral">&#39;UTF-8&#39;</span>),</div><div class="line">                                                                          stPEventInfo.nEventID, nBlockId, nTimestamp))</div><div class="line"></div><div class="line">EVENT_CALL_BACK_FUN = <a class="code" href="namespace_events___interface.html#aab25803c5c5aa89135648c3caf6b95b6">EventInfoCallBack</a>(event_callback)</div><div class="line"></div><div class="line"></div><div class="line"><span class="keywordflow">if</span> __name__ == <span class="stringliteral">&quot;__main__&quot;</span>:</div><div class="line">    <span class="keywordflow">try</span>:</div><div class="line">        <span class="comment"># ch:初始化SDK | en: initialize SDK</span></div><div class="line">        MvCamera.MV_CC_Initialize()</div><div class="line"></div><div class="line">        interfaceList = MV_INTERFACE_INFO_LIST()</div><div class="line">        transportLayerType = MV_GIGE_INTERFACE | MV_CAMERALINK_INTERFACE | MV_CXP_INTERFACE | MV_XOF_INTERFACE</div><div class="line"></div><div class="line">        <span class="comment"># ch:枚举采集卡 | en:Enum interfaces</span></div><div class="line">        ret = MvCamera.MV_CC_EnumInterfaces(transportLayerType, interfaceList)</div><div class="line">        <span class="keywordflow">if</span> ret != 0:</div><div class="line">            print(<span class="stringliteral">&quot;enum interfaces fail! ret[0x%x]&quot;</span> % ret)</div><div class="line">            sys.exit()</div><div class="line"></div><div class="line">        <span class="keywordflow">if</span> interfaceList.nInterfaceNum == 0:</div><div class="line">            print(<span class="stringliteral">&quot;find no interface!&quot;</span>)</div><div class="line">            sys.exit()</div><div class="line"></div><div class="line">        print(<span class="stringliteral">&quot;Find %d interfaces!&quot;</span> % interfaceList.nInterfaceNum)</div><div class="line">        <a class="code" href="namespace_events___interface.html#a9b2d64d2454f4b0d02f048a1b62ffae3">print_interface_info</a>(interfaceList)</div><div class="line"></div><div class="line">        nInterfaceIndex = input(<span class="stringliteral">&quot;please input the number of the interface to connect:&quot;</span>)</div><div class="line"></div><div class="line">        <span class="keywordflow">if</span> int(nInterfaceIndex) &gt;= interfaceList.nInterfaceNum:</div><div class="line">            print(<span class="stringliteral">&quot;input error!&quot;</span>)</div><div class="line">            sys.exit()</div><div class="line"></div><div class="line">        <span class="comment"># ch:创建相机实例 | en:Create Camera Object</span></div><div class="line">        cam_instance = MvCamera()</div><div class="line">        interface_instance = MvCamera()</div><div class="line"></div><div class="line">        <span class="comment"># ch:选择采集卡并创建句柄 | en:Select interface and create handle</span></div><div class="line">        curInterface = cast(interfaceList.pInterfaceInfos[int(nInterfaceIndex)], POINTER(MV_INTERFACE_INFO)).contents</div><div class="line"></div><div class="line">        ret = interface_instance.MV_CC_CreateInterface(curInterface)</div><div class="line">        <span class="keywordflow">if</span> ret != 0:</div><div class="line">            <span class="keywordflow">raise</span> Exception(<span class="stringliteral">&quot;create interface handle fail! ret[0x%x]&quot;</span> % ret)</div><div class="line"></div><div class="line">        <span class="comment"># ch:打开采集卡 | en:Open interface</span></div><div class="line">        ret = interface_instance.MV_CC_OpenInterface()</div><div class="line">        <span class="keywordflow">if</span> ret != 0:</div><div class="line">            <span class="keywordflow">raise</span> Exception(<span class="stringliteral">&quot;open interface fail! ret[0x%x]&quot;</span> % ret)</div><div class="line">        <span class="keywordflow">else</span>:</div><div class="line">            print(<span class="stringliteral">&quot;open interface success&quot;</span>)</div><div class="line"></div><div class="line">        <span class="comment"># ch：开启采集卡ReceiveImageFrameStart0事件 | en: Turn on the ReceiveImageFrameStart0 event of frame grabber</span></div><div class="line">        ret = interface_instance.MV_CC_EventNotificationOn(<span class="stringliteral">&quot;ReceiveImageFrameStart0&quot;</span>)</div><div class="line">        <span class="keywordflow">if</span> ret != 0:</div><div class="line">            <span class="keywordflow">raise</span> Exception(<span class="stringliteral">&quot;Set interface event notification on fail! ret[0x%x]&quot;</span> % ret)</div><div class="line"></div><div class="line">        <span class="comment"># ch:注册采集卡事件回调 | en:Register event callback</span></div><div class="line">        ret = interface_instance.MV_CC_RegisterEventCallBackEx(<span class="stringliteral">&quot;ReceiveImageFrameStart0&quot;</span>, EVENT_CALL_BACK_FUN, <span class="keywordtype">None</span>)</div><div class="line">        <span class="keywordflow">if</span> ret != 0:</div><div class="line">            <span class="keywordflow">raise</span> Exception(<span class="stringliteral">&quot;register event callback fail! ret [0x%x]&quot;</span> % ret)</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment"># ch:关闭采集卡 | en:Close interface</span></div><div class="line">        interface_instance.MV_CC_CloseInterface()</div><div class="line"></div><div class="line">        <span class="comment"># ch:销毁采集卡句柄 | en:Destroy interface</span></div><div class="line">        interface_instance.MV_CC_DestroyInterface()</div><div class="line">    <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div><div class="line">        print(e)</div><div class="line">        cam_instance.MV_CC_CloseDevice()</div><div class="line">        cam_instance.MV_CC_DestroyHandle()</div><div class="line">        interface_instance.MV_CC_CloseInterface()</div><div class="line">        interface_instance.MV_CC_DestroyInterface()</div><div class="line"></div><div class="line">    <span class="keywordflow">finally</span>:</div><div class="line">        <span class="comment"># ch:反初始化SDK | en: finalize SDK</span></div><div class="line">        MvCamera.MV_CC_Finalize()</div></div><!-- fragment --> <dl class="section note"><dt>注解</dt><dd>枚举设备和创建采集卡实例步骤的示例代码可参考<a class="el" href="_xE5_x88_x9D_xE5_xA7_x8B_xE5_x8C_x96_xE9_x87_x87_xE9_x9B_x86_xE5_x8D_xA1.html">初始化采集卡</a> 章节。<br />
  </dd></dl>
<div id="abnormal"> <div class="mainparams"> <h2 id="异常事件">异常事件</h2>
</div></div></div></div></div><div><div id="eventGrab"><div class="subparamswhite"><div id="abnormal"><div class="mainparams"> </div> <div class="subparamswhite"> </div></div></div></div></div><div><div id="eventGrab"><div class="subparamswhite"><div id="abnormal"><div class="subparamswhite">异常告警事件可直接从SDK中获取。该类型事件的处理流程包括注册、获取和注销。</div></div></div></div></div><div><div id="eventGrab"><div class="subparamswhite"><div id="abnormal"><div class="subparamswhite"> <ol>
<li>
<p class="startli"></p>
<p class="interli"><b>注册</b>：通过函数 <a class="el" href="group___xE4_xBA_x8B_xE4_xBB_xB6_xE5_x8F_x8A_xE5_xBC_x82_xE5_xB8_xB8.html#gad407b94a499741e5e05aebfd7314ee44" title="注册异常消息回调，在打开设备之后调用">MV_CC_RegisterExceptionCallBack()</a> 注册异常事件，若出现异常情况时，则异常会及时上报给SDK。</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"></p>
<p class="interli"><b>获取</b>：当SDK出现异常时，会触发异常事件回调函数。该函数可将异常告警事件推送给用户。</p>
<dl class="section attention"><dt>注意</dt><dd>请勿通过异常事件回调函数执行耗时较长的操作，否则将导致后续事件信息的推送被阻塞。 </dd></dl>
</li>
<li>
<p class="startli"></p>
<p class="interli"><b>注销</b>：调用 <a class="el" href="group___xE4_xBA_x8B_xE4_xBB_xB6_xE5_x8F_x8A_xE5_xBC_x82_xE5_xB8_xB8.html#gad407b94a499741e5e05aebfd7314ee44" title="注册异常消息回调，在打开设备之后调用">MV_CC_RegisterExceptionCallBack()</a> 注销异常告警事件。当异常回调函数为NULL时，可取消采集卡或相机实例的设备异常事件。</p>
<p class="interli"></p>
<p class="interli">如下示例代码演示了如何订阅、处理和取消订阅异常事件。</p>
<div class="fragment"><div class="line">ExceptionInfoCallBack = <a class="code" href="namespace_parametrize_camera___area_scan_i_o_settings.html#a3bae6d695a340d90cc6e249839d03825">winfun_ctype</a>(<span class="keywordtype">None</span>, c_uint, c_void_p)</div><div class="line"><span class="keyword">def </span>exception_callback(MsgType, pUser):</div><div class="line">    <span class="keywordflow">print</span> (<span class="stringliteral">&quot;exception_callback Recv MsgType[%d] &quot;</span> % (MsgType))</div><div class="line"></div><div class="line">CALL_BACK_FUN = ExceptionInfoCallBack(exception_callback)</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keywordflow">if</span> __name__ == <span class="stringliteral">&quot;__main__&quot;</span>:</div><div class="line">    <span class="comment"># ch:初始化SDK | en: initialize SDK</span></div><div class="line">    MvCamera.MV_CC_Initialize()</div><div class="line">    </div><div class="line"></div><div class="line">    <span class="comment"># ch: 枚举相机</span></div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment"># ch:创建相机实例 | en:Creat Camera Object</span></div><div class="line">    cam = MvCamera()</div><div class="line"></div><div class="line">    <span class="comment"># ch:选择设备并创建句柄 | en:Select device and create handle</span></div><div class="line">    stDeviceList = cast(deviceList.pDeviceInfo[int(nConnectionNum)], POINTER(MV_CC_DEVICE_INFO)).contents</div><div class="line"></div><div class="line">    ret = cam.MV_CC_CreateHandle(stDeviceList)</div><div class="line">    <span class="keywordflow">if</span> ret != 0:</div><div class="line">        <span class="keywordflow">print</span> (<span class="stringliteral">&quot;create handle fail! ret[0x%x]&quot;</span> % ret)</div><div class="line">        sys.exit()</div><div class="line"></div><div class="line">    <span class="comment"># ch:打开设备 | en:Open device</span></div><div class="line">    ret = cam.MV_CC_OpenDevice()</div><div class="line">    <span class="comment">#ret = cam.MV_CC_OpenDevice(MV_ACCESS_Exclusive, 0)</span></div><div class="line">    <span class="keywordflow">if</span> ret != 0:</div><div class="line">        <span class="keywordflow">print</span> (<span class="stringliteral">&quot;open device fail! ret[0x%x]&quot;</span> % ret)</div><div class="line">        sys.exit()</div><div class="line">    </div><div class="line"></div><div class="line">    <span class="comment"># ch:注册事件回调 | en:Register event callback</span></div><div class="line">    ret = cam.MV_CC_RegisterExceptionCallBack(CALL_BACK_FUN,<span class="keywordtype">None</span>)</div><div class="line">    <span class="keywordflow">if</span> ret != 0:</div><div class="line">        <span class="keywordflow">print</span> (<span class="stringliteral">&quot;register event callback fail! ret [0x%x]&quot;</span> % ret)</div><div class="line">        sys.exit()</div><div class="line"></div><div class="line">    <span class="comment"># ch:开始取流 | en:Start grab image</span></div><div class="line">    <span class="keywordflow">print</span> (<span class="stringliteral">&quot;press a key to stop grabbing.&quot;</span>)</div><div class="line">    <a class="code" href="namespace_parametrize_camera___area_scan_i_o_settings.html#ada091daac0b443feeefd371689422720">press_any_key_exit</a>()</div><div class="line"></div><div class="line">    <span class="keywordflow">print</span> (<span class="stringliteral">&quot;press a key to stop grabbing.&quot;</span>)</div><div class="line">    msvcrt.getch()</div><div class="line"></div><div class="line">    <span class="comment"># ch:停止取流 | en:Stop grab image</span></div><div class="line">    ret = cam.MV_CC_StopGrabbing()</div><div class="line">    <span class="keywordflow">if</span> ret != 0:</div><div class="line">        <span class="keywordflow">print</span> (<span class="stringliteral">&quot;stop grabbing fail! ret[0x%x]&quot;</span> % ret)</div><div class="line">        sys.exit()</div><div class="line"></div><div class="line">    <span class="comment"># ch:关闭设备 | Close device</span></div><div class="line">    ret = cam.MV_CC_CloseDevice()</div><div class="line">    <span class="keywordflow">if</span> ret != 0:</div><div class="line">        <span class="keywordflow">print</span> (<span class="stringliteral">&quot;close deivce fail! ret[0x%x]&quot;</span> % ret)</div><div class="line">        sys.exit()</div><div class="line"></div><div class="line">    <span class="comment"># ch:销毁句柄 | Destroy handle</span></div><div class="line">    ret = cam.MV_CC_DestroyHandle()</div><div class="line">    <span class="keywordflow">if</span> ret != 0:</div><div class="line">        <span class="keywordflow">print</span> (<span class="stringliteral">&quot;destroy handle fail! ret[0x%x]&quot;</span> % ret)</div><div class="line">        sys.exit()</div><div class="line"></div><div class="line">    <span class="comment"># ch:反初始化SDK | en: finalize SDK</span></div><div class="line">    MvCamera.MV_CC_Finalize()</div></div><!-- fragment --> <dl class="section note"><dt>注解</dt><dd>枚举设备和创建实例步骤的示例代码参见<a class="el" href="_xE5_x88_x9D_xE5_xA7_x8B_xE5_x8C_x96_xE9_x87_x87_xE9_x9B_x86_xE5_x8D_xA1.html">初始化采集卡</a> 章节或<a class="el" href="_xE5_x88_x9D_xE5_xA7_x8B_xE5_x8C_x96_xE7_x9B_xB8_xE6_x9C_xBA.html">初始化相机</a> 章节。 </dd></dl>
</li>
</ol>
</div> </div></div></div></div><div><div id="eventGrab"><div class="subparamswhite"> <div id="cache"> <div class="mainparams"> <h2 id="事件缓存调节">事件缓存调节</h2>
</div></div></div></div></div><div><div id="eventGrab"><div class="subparamswhite"><div id="cache"><div class="mainparams"> </div> <div class="subparamswhite"> </div></div></div></div></div><div><div id="eventGrab"><div class="subparamswhite"><div id="cache"><div class="subparamswhite">GigE相机产生的事件使用socket缓冲区，不需要额外配置缓存区，而U3V设备产生的事件通过事件端点或链路上报。在SDK内部，默认有5个缓存节点可以接收事件。若上层软件处理速度较慢或者设备上报事件的频率较高，则可能导致SDK内部缓存不足，导致丢事件的情况发生。此时，您可以通过 <a class="el" href="group___u3_v_xE8_xAE_xBE_xE5_xA4_x87.html#ga9a53218aa7eb696825f6d2cb876d9c8e" title="设置U3V的事件缓存节点个数">MV_USB_SetEventNodeNum()</a> 修改U3V相机SDK内部的事件缓存节点数量。</div></div></div></div></div><div><div id="eventGrab"><div class="subparamswhite"><div id="cache"><div class="subparamswhite"> <div class="fragment"><div class="line"><span class="comment"># 调节SDK 内部U3V设备的Event事件缓冲区数量</span></div><div class="line">EventNodeNum = 5</div><div class="line">ret = cam.MV_USB_SetEventNodeNum(EventNodeNum)</div><div class="line"><span class="keywordflow">if</span> ret != 0:</div><div class="line">    <span class="keywordflow">print</span> (<span class="stringliteral">&quot;MV_USB_SetEventNodeNum fail! ret[0x%x]&quot;</span> % ret)</div><div class="line">    sys.exit()</div></div><!-- fragment --> </div> </div></div></div></div><div><div id="eventGrab"><div class="subparamswhite"> <div> <br />
 <br />
 <br />
 <table width="60%">
<tr>
<td>上一篇： <a class="el" href="_xE8_xAE_xBE_xE7_xBD_xAE_xE5_x8F_x82_xE6_x95_xB0.html">设置参数</a> </td><td>下一篇： <a class="el" href="_xE9_x87_x87_xE9_x9B_x86_xE5_x9B_xBE_xE5_x83_x8F.html">采集图像</a>  </td></tr>
</table>
</div> </div> </div></div></div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<div class="footer" style="text-align: right;">
	<hr/>
	<small></small>
</div>
</body>
</html>