<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=GB2312"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="custom-style.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
	<div style="overflow: hidden;">
		<div style="height: 57px;min-width: 1039px;background-size: auto 100%;background:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABwgAAAABCAYAAADKO/rAAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABRSURBVFhH7dUxCoBADEXB5LK5/w1iIaLIrsgWNs50Sf/4WVUd8HOZGd1nCqMbGNMPrNMPrJv1cvz0A3OjfuwPvDPrxf7A7t7IlX7gmX74VsQGguw4S6+UnSYAAAAASUVORK5CYII=');">
			<img src="titleleft.png" style="float: left;"/>
			<img src="titleright.png" alt="" style="float: right;" />
		</div>
	</div>
<!-- 制作者 Doxygen 1.8.15 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>首页</span></a></li>
      <li><a href="_xE5_x8F_x91_xE7_x89_x88_xE8_xAF_xB4_xE6_x98_x8E.html"><span>发版说明</span></a></li>
      <li><a href="usergroup0.html"><span>编程引导</span></a></li>
      <li><a href="modules.html"><span>API参考</span></a></li>
      <li><a href="_xE6_x8E_xA7_xE5_x88_xB6_xE5_x8F_xB0_xE7_xA4_xBA_xE4_xBE_x8B_xE7_xA8_x8B_xE5_xBA_x8F.html"><span>示例程序</span></a></li>
      <li><a href="_xE6_xB3_x95_xE5_xBE_x8B_xE5_xA3_xB0_xE6_x98_x8E.html"><span>法律声明</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="PageDoc"><div class="contents">
<div class="textblock"><div class="header" style="margin-left:-12px;margin-top:-10px;margin-right:-8px;"> <div class="headertitle"> <div class="title">处理图像</div> </div> </div> <div id="hikvision"> <br />
 </div><div id="hikvision">在获取到相机图像后，工业采集卡SDK提供了一套图像处理的辅助接口，可以使用采集卡句柄、相机句柄或者流句柄调用这些接口。</div><div id="hikvision"> <ul>
<li>
<a href="#xianshituxiang" class="el">显示图像</a> </li>
<li>
<a href="#baocuntuxiang" class="el">保存图像</a> </li>
<li>
<a href="#xiangsugeshizhuanhuan" class="el">像素格式转换</a> </li>
<li>
<a href="#jiematuxiang" class="el">解码图像</a> </li>
<li>
<a href="#chongzutuxiang" class="el">重组图像</a> </li>
</ul>
<br />
 </div><div class="header" style="margin-left:-12px;margin-top:-10px;margin-right:-8px;"> <div class="headertitle"> <div id="xianshituxiang" class="title">显示图像</div> </div> </div> <div id="hikvision"> <br />
 </div><div id="hikvision">通过调用 <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86_xE6_x8E_xA5_xE5_x8F_xA3.html#ga88588e40c4e1f6dcb4f03c6bdeae09b4" title="显示一帧图像">MV_FG_DisplayOneFrame()</a> 接口，输入显示图像的窗口句柄和想要显示的图像信息，对图像进行显示。图像信息中包含有图像宽度、图像高度、图像像素格式和图像数据等内容。应当注意的是，显示图像是耗时的，建议使用异步方式对图像进行显示，否则可能会影响取流及时性或者造成取流回调阻塞的问题。另外受限于主板性能较差、CPU占用率过高或者相机帧率较高等因素，可能会存在无法满帧率显示所有图像的情况。</div><div id="hikvision"> <br />
 </div><div class="header" style="margin-left:-12px;margin-top:-10px;margin-right:-8px;"> <div class="headertitle"> <div id="baocuntuxiang" class="title">保存图像</div> </div> </div> <div id="hikvision"> <br />
 </div><div id="hikvision">工业采集卡SDK支持BMP、JPEG、TIFF和PNG四种图像格式的存图功能。</div><div id="hikvision"> <ul>
<li>
通过调用 <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86_xE6_x8E_xA5_xE5_x8F_xA3.html#gad20737201aca2cfa4b73774cf6dd90dd" title="保存BMP图像">MV_FG_SaveBitmap()</a> 接口，输入图像信息，将图像转成BMP格式并保存到缓存中。应当注意的是，当前SDK只支持保存8bit的Mono8灰度图、24bit的BGR24彩色图和32bit的BGRA32彩色图，输入的其它格式图像都会先自适应转换成这三种格式中的其中一种，再进行存图。同时输入Bayer格式的图像时，配套提供了插值方法可供选择，具体可以参考<a class="el" href="group___xE6_x9E_x9A_xE4_xB8_xBE_xE7_xB1_xBB_xE5_x9E_x8B_xE5_xAE_x9A_xE4_xB9_x89.html#ga43ecafe80a7f8258da82fbeb3f13c340">MV_FG_CFA_METHOD</a> 。<br />
 下面的代码片段演示了保存BMP的过程：<br />
 <div class="fragment"><div class="line"><span class="comment">/*保存BMP图像*/</span></div><div class="line"><a class="code" href="struct_m_v___f_g___s_a_v_e___b_i_t_m_a_p___i_n_f_o.html">MV_FG_SAVE_BITMAP_INFO</a> stSaveBitmapInfo = {0};</div><div class="line">stSaveBitmapInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___b_i_t_m_a_p___i_n_f_o.html#aad74022a79f9800f72ba8ad2ced2ea95">stInputImageInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_p_u_t___i_m_a_g_e___i_n_f_o.html#abbc1b35442c6143931edc0189a3432fb">nWidth</a> = stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#abbc1b35442c6143931edc0189a3432fb">nWidth</a>;</div><div class="line">stSaveBitmapInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___b_i_t_m_a_p___i_n_f_o.html#aad74022a79f9800f72ba8ad2ced2ea95">stInputImageInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_p_u_t___i_m_a_g_e___i_n_f_o.html#a2e4c6b811457a16b7033af6741cfb1db">nHeight</a> = stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#a2e4c6b811457a16b7033af6741cfb1db">nHeight</a>;</div><div class="line">stSaveBitmapInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___b_i_t_m_a_p___i_n_f_o.html#aad74022a79f9800f72ba8ad2ced2ea95">stInputImageInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_p_u_t___i_m_a_g_e___i_n_f_o.html#abc1a908f027ad8af045a2ad75df2faa3">enPixelType</a> = stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#abc1a908f027ad8af045a2ad75df2faa3">enPixelType</a>;</div><div class="line">stSaveBitmapInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___b_i_t_m_a_p___i_n_f_o.html#aad74022a79f9800f72ba8ad2ced2ea95">stInputImageInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_p_u_t___i_m_a_g_e___i_n_f_o.html#a0d04695d82775f55e4d7ed51c8c983e2">pImageBuf</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#ab48e189d395e833f208732a779e526c0">pBuffer</a>;</div><div class="line">stSaveBitmapInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___b_i_t_m_a_p___i_n_f_o.html#aad74022a79f9800f72ba8ad2ced2ea95">stInputImageInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_p_u_t___i_m_a_g_e___i_n_f_o.html#a1dc2e86fcfcb0cfe25b292cc6089169e">nImageBufLen</a> = stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#ac1821e4c0315f6c0ebbcf907f835f6f6">nFilledSize</a>;</div><div class="line"></div><div class="line"><span class="comment">/*输出缓存大小需要根据实际保存的图像格式进行赋值，比如Bayer格式会先转换成BGR24格式，那么输出缓存大小应该是宽*高*3，再加上一个BMP头长度；如果转换后是Mono8格式，则不需要乘以3*/</span></div><div class="line">stSaveBitmapInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___b_i_t_m_a_p___i_n_f_o.html#af94a4545a8863496b000eab32acd88fb">nBmpBufSize</a> = stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#abbc1b35442c6143931edc0189a3432fb">nWidth</a> * stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#a2e4c6b811457a16b7033af6741cfb1db">nHeight</a> * 3 + 1024;</div><div class="line">stSaveBitmapInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___b_i_t_m_a_p___i_n_f_o.html#a9f2a6565a153e1c47d27b214bf98f2a6">pBmpBuf</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)malloc(stSaveBitmapInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___b_i_t_m_a_p___i_n_f_o.html#af94a4545a8863496b000eab32acd88fb">nBmpBufSize</a>);</div><div class="line"></div><div class="line"><span class="comment">/*Bayer格式时需要输入插值方法*/</span></div><div class="line">stSaveBitmapInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___b_i_t_m_a_p___i_n_f_o.html#a7c510d92014729fb4e05916a04ae5ebe">enCfaMethod</a> = <a class="code" href="group___xE6_x9E_x9A_xE4_xB8_xBE_xE7_xB1_xBB_xE5_x9E_x8B_xE5_xAE_x9A_xE4_xB9_x89.html#gga43ecafe80a7f8258da82fbeb3f13c340ac26e37b9b9b1b3bd7f607e21437f5ddc">MV_FG_CFA_METHOD_OPTIMAL</a>;</div><div class="line">nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86_xE6_x8E_xA5_xE5_x8F_xA3.html#gad20737201aca2cfa4b73774cf6dd90dd">MV_FG_SaveBitmap</a>(hStream<span class="comment">/*hInterface*/</span><span class="comment">/*hDevice*/</span>, &amp;stSaveBitmapInfo);</div><div class="line">Check(nRet);</div><div class="line"></div><div class="line"><span class="comment">/*将BMP图像写入文件*/</span></div><div class="line">FILE* fp = fopen(<span class="stringliteral">&quot;./Image.bmp&quot;</span>, <span class="stringliteral">&quot;wb+&quot;</span>);</div><div class="line"><span class="keywordflow">if</span> (fp)</div><div class="line">{</div><div class="line">    fwrite(stSaveBitmapInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___b_i_t_m_a_p___i_n_f_o.html#a9f2a6565a153e1c47d27b214bf98f2a6">pBmpBuf</a>, stSaveBitmapInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___b_i_t_m_a_p___i_n_f_o.html#ac8167f886425bd7338103770eb7d2072">nBmpBufLen</a>, 1, fp);</div><div class="line">    fclose(fp);</div><div class="line">}</div></div><!-- fragment -->  </li>
<li>
通过调用 <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86_xE6_x8E_xA5_xE5_x8F_xA3.html#gacf27f8d76b7348812708b07e68f5ceba" title="保存JPEG图像">MV_FG_SaveJpeg()</a> 接口，输入图像信息，将图像编码成JPEG格式并保存到缓存中。JPEG编码是有损的，SDK提供了编码质量参数，范围为(0-100]。应当注意的是，当前SDK只支持对8bit的Mono8灰度图、24bit的BGR24彩色图和32bit的BGRA32彩色图进行JPEG编码，输入的其它格式图像都会先自适应转换成这三种格式中的其中一种，再进行编码。同时输入Bayer格式的图像时，配套提供了插值方法可供选择，具体可以参考<a class="el" href="group___xE6_x9E_x9A_xE4_xB8_xBE_xE7_xB1_xBB_xE5_x9E_x8B_xE5_xAE_x9A_xE4_xB9_x89.html#ga43ecafe80a7f8258da82fbeb3f13c340">MV_FG_CFA_METHOD</a> 。<br />
 下面的代码片段演示了保存JPEG的过程：<br />
 <div class="fragment"><div class="line"><span class="comment">/*保存JPEG图像*/</span></div><div class="line"><a class="code" href="struct_m_v___f_g___s_a_v_e___j_p_e_g___i_n_f_o.html">MV_FG_SAVE_JPEG_INFO</a> stSaveJpegInfo = {0};</div><div class="line">stSaveJpegInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___j_p_e_g___i_n_f_o.html#aad74022a79f9800f72ba8ad2ced2ea95">stInputImageInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_p_u_t___i_m_a_g_e___i_n_f_o.html#abbc1b35442c6143931edc0189a3432fb">nWidth</a> = stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#abbc1b35442c6143931edc0189a3432fb">nWidth</a>;</div><div class="line">stSaveJpegInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___j_p_e_g___i_n_f_o.html#aad74022a79f9800f72ba8ad2ced2ea95">stInputImageInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_p_u_t___i_m_a_g_e___i_n_f_o.html#a2e4c6b811457a16b7033af6741cfb1db">nHeight</a> = stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#a2e4c6b811457a16b7033af6741cfb1db">nHeight</a>;</div><div class="line">stSaveJpegInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___j_p_e_g___i_n_f_o.html#aad74022a79f9800f72ba8ad2ced2ea95">stInputImageInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_p_u_t___i_m_a_g_e___i_n_f_o.html#abc1a908f027ad8af045a2ad75df2faa3">enPixelType</a> = stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#abc1a908f027ad8af045a2ad75df2faa3">enPixelType</a>;</div><div class="line">stSaveJpegInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___j_p_e_g___i_n_f_o.html#aad74022a79f9800f72ba8ad2ced2ea95">stInputImageInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_p_u_t___i_m_a_g_e___i_n_f_o.html#a0d04695d82775f55e4d7ed51c8c983e2">pImageBuf</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#ab48e189d395e833f208732a779e526c0">pBuffer</a>;</div><div class="line">stSaveJpegInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___j_p_e_g___i_n_f_o.html#aad74022a79f9800f72ba8ad2ced2ea95">stInputImageInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_p_u_t___i_m_a_g_e___i_n_f_o.html#a1dc2e86fcfcb0cfe25b292cc6089169e">nImageBufLen</a> = stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#ac1821e4c0315f6c0ebbcf907f835f6f6">nFilledSize</a>;</div><div class="line"></div><div class="line"><span class="comment">/*由于JPEG编码前并不知道需要多大的输出缓存，所以输出缓存大小也是需要根据实际保存的图像格式进行赋值，比如Bayer格式会先转换成BGR24格式，那么输出缓存大小应该是宽*高*3，再加上一个BMP头长度；如果转换后是Mono8格式，则不需要乘以3*/</span></div><div class="line">stSaveJpegInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___j_p_e_g___i_n_f_o.html#a176a593fb1083db3c2eb1ff2860ee8a6">nJpgBufSize</a> = stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#abbc1b35442c6143931edc0189a3432fb">nWidth</a> * stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#a2e4c6b811457a16b7033af6741cfb1db">nHeight</a> * 3 + 1024;</div><div class="line">stSaveJpegInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___j_p_e_g___i_n_f_o.html#a9e46d50a0344900e97987966ae06060b">pJpgBuf</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)malloc(stSaveJpegInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___j_p_e_g___i_n_f_o.html#a176a593fb1083db3c2eb1ff2860ee8a6">nJpgBufSize</a>);</div><div class="line">stSaveJpegInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___j_p_e_g___i_n_f_o.html#a170032d0a182885306c74447a51212b5">nJpgQuality</a> = 80;</div><div class="line"></div><div class="line"><span class="comment">/*Bayer格式时需要输入插值方法*/</span></div><div class="line">stSaveJpegInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___j_p_e_g___i_n_f_o.html#a7c510d92014729fb4e05916a04ae5ebe">enCfaMethod</a> = <a class="code" href="group___xE6_x9E_x9A_xE4_xB8_xBE_xE7_xB1_xBB_xE5_x9E_x8B_xE5_xAE_x9A_xE4_xB9_x89.html#gga43ecafe80a7f8258da82fbeb3f13c340ac26e37b9b9b1b3bd7f607e21437f5ddc">MV_FG_CFA_METHOD_OPTIMAL</a>;</div><div class="line">nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86_xE6_x8E_xA5_xE5_x8F_xA3.html#gacf27f8d76b7348812708b07e68f5ceba">MV_FG_SaveJpeg</a>(hStream<span class="comment">/*hInterface*/</span><span class="comment">/*hDevice*/</span>, &amp;stSaveJpegInfo);</div><div class="line">Check(nRet);</div><div class="line"></div><div class="line"><span class="comment">/*将JPEG图像写入文件*/</span></div><div class="line">FILE* fp = fopen(<span class="stringliteral">&quot;./Image.jpeg&quot;</span>, <span class="stringliteral">&quot;wb+&quot;</span>);</div><div class="line"><span class="keywordflow">if</span> (fp)</div><div class="line">{</div><div class="line">    fwrite(stSaveJpegInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___j_p_e_g___i_n_f_o.html#a9e46d50a0344900e97987966ae06060b">pJpgBuf</a>, stSaveJpegInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___j_p_e_g___i_n_f_o.html#a9b9d2514ccc295031dfa9cf9ee73d310">nJpgBufLen</a>, 1, fp);</div><div class="line">    fclose(fp);</div><div class="line">}</div></div><!-- fragment -->  </li>
<li>
通过调用 <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86_xE6_x8E_xA5_xE5_x8F_xA3.html#ga0377193a3455a2a40469b2e3d2ba226a" title="保存TIFF图像">MV_FG_SaveTiffToFile()</a> 接口，输入图像信息，将图像转成TIFF格式并保存到文件中。SDK会按照图像通道数和每通道bit数进行分别保存，一般情况下不会改变实际图像的数据内容，比如BayerRG8图像保存成TIFF格式时，会按照1通道和8bit方式进行保存，不会进行色彩插值。存图时可以根据实际情况调节TIFF格式的水平分辨率和垂直分辨率。<br />
 下面的代码片段演示了保存TIFF的过程：<br />
 <div class="fragment"><div class="line"><span class="comment">/*保存TIFF图像*/</span></div><div class="line"><a class="code" href="struct_m_v___f_g___s_a_v_e___t_i_f_f___t_o___f_i_l_e___i_n_f_o.html">MV_FG_SAVE_TIFF_TO_FILE_INFO</a> stSaveTiffInfo = {0};</div><div class="line">stSaveTiffInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___t_i_f_f___t_o___f_i_l_e___i_n_f_o.html#aad74022a79f9800f72ba8ad2ced2ea95">stInputImageInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_p_u_t___i_m_a_g_e___i_n_f_o.html#abbc1b35442c6143931edc0189a3432fb">nWidth</a> = stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#abbc1b35442c6143931edc0189a3432fb">nWidth</a>;</div><div class="line">stSaveTiffInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___t_i_f_f___t_o___f_i_l_e___i_n_f_o.html#aad74022a79f9800f72ba8ad2ced2ea95">stInputImageInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_p_u_t___i_m_a_g_e___i_n_f_o.html#a2e4c6b811457a16b7033af6741cfb1db">nHeight</a> = stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#a2e4c6b811457a16b7033af6741cfb1db">nHeight</a>;</div><div class="line">stSaveTiffInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___t_i_f_f___t_o___f_i_l_e___i_n_f_o.html#aad74022a79f9800f72ba8ad2ced2ea95">stInputImageInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_p_u_t___i_m_a_g_e___i_n_f_o.html#abc1a908f027ad8af045a2ad75df2faa3">enPixelType</a> = stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#abc1a908f027ad8af045a2ad75df2faa3">enPixelType</a>;</div><div class="line">stSaveTiffInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___t_i_f_f___t_o___f_i_l_e___i_n_f_o.html#aad74022a79f9800f72ba8ad2ced2ea95">stInputImageInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_p_u_t___i_m_a_g_e___i_n_f_o.html#a0d04695d82775f55e4d7ed51c8c983e2">pImageBuf</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#ab48e189d395e833f208732a779e526c0">pBuffer</a>;</div><div class="line">stSaveTiffInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___t_i_f_f___t_o___f_i_l_e___i_n_f_o.html#aad74022a79f9800f72ba8ad2ced2ea95">stInputImageInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_p_u_t___i_m_a_g_e___i_n_f_o.html#a1dc2e86fcfcb0cfe25b292cc6089169e">nImageBufLen</a> = stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#ac1821e4c0315f6c0ebbcf907f835f6f6">nFilledSize</a>;</div><div class="line">stSaveTiffInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___t_i_f_f___t_o___f_i_l_e___i_n_f_o.html#ab72477b4420b2a07dfd2c9fe03ee41c2">pcImagePath</a> = <span class="stringliteral">&quot;./Image.tiff&quot;</span>;</div><div class="line">stSaveTiffInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___t_i_f_f___t_o___f_i_l_e___i_n_f_o.html#ab30a83239ae8bd2f4d5206051e9530a1">fXResolution</a>= 96.0f;</div><div class="line">stSaveTiffInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___t_i_f_f___t_o___f_i_l_e___i_n_f_o.html#a7056426d6708dc381ee8330151a4b564">fYResolution</a>= 96.0f;</div><div class="line">stSaveTiffInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___t_i_f_f___t_o___f_i_l_e___i_n_f_o.html#a60aad6d88bbc43ca41aab0be2a73a825">enResolutionUnit</a>= <a class="code" href="group___xE6_x9E_x9A_xE4_xB8_xBE_xE7_xB1_xBB_xE5_x9E_x8B_xE5_xAE_x9A_xE4_xB9_x89.html#ggaad93f4dd0bea277d8453605326b47769ab538aec6bd9ed09a60144f799e5e0f00">MV_FG_Resolution_Unit_Inch</a>;</div><div class="line">nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86_xE6_x8E_xA5_xE5_x8F_xA3.html#ga0377193a3455a2a40469b2e3d2ba226a">MV_FG_SaveTiffToFile</a>(hStream<span class="comment">/*hInterface*/</span><span class="comment">/*hDevice*/</span>, &amp;stSaveTiffInfo);</div><div class="line">Check(nRet);</div></div><!-- fragment -->  </li>
<li>
通过调用 <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86_xE6_x8E_xA5_xE5_x8F_xA3.html#ga92949b24dc04fe8099a920d63194a595" title="保存PNG图像">MV_FG_SavePngToFile()</a> 接口，输入图像信息，将图像编码成PNG格式并保存到文件中。PNG编码是无损的，SDK提供了编码压缩率参数，范围为[0-9]。应当注意的是，当前SDK只支持对8bit的Mono8灰度图、24bit的RGB24彩色图和32bit的RGBA32彩色图进行PNG编码，输入的其它格式图像都会先自适应转换成这三种格式中的其中一种，再进行编码。同时输入Bayer格式的图像时，配套提供了插值方法可供选择，具体可以参考<a class="el" href="group___xE6_x9E_x9A_xE4_xB8_xBE_xE7_xB1_xBB_xE5_x9E_x8B_xE5_xAE_x9A_xE4_xB9_x89.html#ga43ecafe80a7f8258da82fbeb3f13c340">MV_FG_CFA_METHOD</a> 。<br />
 下面的代码片段演示了保存PNG的过程：<br />
 <div class="fragment"><div class="line"><span class="comment">/*保存PNG图像*/</span></div><div class="line"><a class="code" href="struct_m_v___f_g___s_a_v_e___p_n_g___t_o___f_i_l_e___i_n_f_o.html">MV_FG_SAVE_PNG_TO_FILE_INFO</a> stSavePngInfo = {0};</div><div class="line">stSavePngInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___p_n_g___t_o___f_i_l_e___i_n_f_o.html#aad74022a79f9800f72ba8ad2ced2ea95">stInputImageInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_p_u_t___i_m_a_g_e___i_n_f_o.html#abbc1b35442c6143931edc0189a3432fb">nWidth</a> = stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#abbc1b35442c6143931edc0189a3432fb">nWidth</a>;</div><div class="line">stSavePngInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___p_n_g___t_o___f_i_l_e___i_n_f_o.html#aad74022a79f9800f72ba8ad2ced2ea95">stInputImageInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_p_u_t___i_m_a_g_e___i_n_f_o.html#a2e4c6b811457a16b7033af6741cfb1db">nHeight</a> = stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#a2e4c6b811457a16b7033af6741cfb1db">nHeight</a>;</div><div class="line">stSavePngInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___p_n_g___t_o___f_i_l_e___i_n_f_o.html#aad74022a79f9800f72ba8ad2ced2ea95">stInputImageInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_p_u_t___i_m_a_g_e___i_n_f_o.html#abc1a908f027ad8af045a2ad75df2faa3">enPixelType</a> = stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#abc1a908f027ad8af045a2ad75df2faa3">enPixelType</a>;</div><div class="line">stSavePngInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___p_n_g___t_o___f_i_l_e___i_n_f_o.html#aad74022a79f9800f72ba8ad2ced2ea95">stInputImageInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_p_u_t___i_m_a_g_e___i_n_f_o.html#a0d04695d82775f55e4d7ed51c8c983e2">pImageBuf</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#ab48e189d395e833f208732a779e526c0">pBuffer</a>;</div><div class="line">stSavePngInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___p_n_g___t_o___f_i_l_e___i_n_f_o.html#aad74022a79f9800f72ba8ad2ced2ea95">stInputImageInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_p_u_t___i_m_a_g_e___i_n_f_o.html#a1dc2e86fcfcb0cfe25b292cc6089169e">nImageBufLen</a> = stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#ac1821e4c0315f6c0ebbcf907f835f6f6">nFilledSize</a>;</div><div class="line">stSavePngInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___p_n_g___t_o___f_i_l_e___i_n_f_o.html#ab72477b4420b2a07dfd2c9fe03ee41c2">pcImagePath</a> = <span class="stringliteral">&quot;./Image.png&quot;</span>;</div><div class="line">stSavePngInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___p_n_g___t_o___f_i_l_e___i_n_f_o.html#a69df0ef8b1128c52fb5e76fced8cbc17">nPngCompression</a> = 8;</div><div class="line"></div><div class="line"><span class="comment">/*Bayer格式时需要输入插值方法*/</span></div><div class="line">stSavePngInfo.<a class="code" href="struct_m_v___f_g___s_a_v_e___p_n_g___t_o___f_i_l_e___i_n_f_o.html#a7c510d92014729fb4e05916a04ae5ebe">enCfaMethod</a> = <a class="code" href="group___xE6_x9E_x9A_xE4_xB8_xBE_xE7_xB1_xBB_xE5_x9E_x8B_xE5_xAE_x9A_xE4_xB9_x89.html#gga43ecafe80a7f8258da82fbeb3f13c340ac26e37b9b9b1b3bd7f607e21437f5ddc">MV_FG_CFA_METHOD_OPTIMAL</a>;</div><div class="line">nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86_xE6_x8E_xA5_xE5_x8F_xA3.html#ga92949b24dc04fe8099a920d63194a595">MV_FG_SavePngToFile</a>(hStream<span class="comment">/*hInterface*/</span><span class="comment">/*hDevice*/</span>, &amp;stSavePngInfo);</div><div class="line">Check(nRet);</div></div><!-- fragment -->  </li>
</ul>
<br />
 </div><div class="header" style="margin-left:-12px;margin-top:-10px;margin-right:-8px;"> <div class="headertitle"> <div id="xiangsugeshizhuanhuan" class="title">像素格式转换</div> </div> </div> <div id="hikvision"> <br />
 </div><div id="hikvision">通过调用 <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86_xE6_x8E_xA5_xE5_x8F_xA3.html#gaad1d64970f2fcb2f896eb2164a37bcea" title="像素格式转换">MV_FG_ConvertPixelType()</a> 接口，输入图像信息和目的像素格式，对图像进行像素格式转换。该接口主要是为了将相机输出的图像格式转换成实际所需要的格式，比如将YUV422格式转换成RGB格式，将Bayer格式插值成RGB/BGR格式，将Mono12格式转换成Mono16格式等。应当注意的是，在Bayer格式插值成RGB/BGR格式时，该接口不仅支持插值方法选择，还支持一些算法功能，比如平滑滤波、Gamma校正和CCM校正等，具体可以参考 <a class="el" href="struct_m_v___f_g___c_o_n_v_e_r_t___p_i_x_e_l___i_n_f_o.html" title="像素格式转换信息">MV_FG_CONVERT_PIXEL_INFO</a> 。</div><div id="hikvision"> <div class="fragment"><div class="line"><span class="comment">/*像素格式转换，以BayerRG8插值为例*/</span></div><div class="line"><a class="code" href="struct_m_v___f_g___c_o_n_v_e_r_t___p_i_x_e_l___i_n_f_o.html">MV_FG_CONVERT_PIXEL_INFO</a> stConvertPixelInfo = {0};</div><div class="line">stConvertPixelInfo.<a class="code" href="struct_m_v___f_g___c_o_n_v_e_r_t___p_i_x_e_l___i_n_f_o.html#aad74022a79f9800f72ba8ad2ced2ea95">stInputImageInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_p_u_t___i_m_a_g_e___i_n_f_o.html#abbc1b35442c6143931edc0189a3432fb">nWidth</a> = stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#abbc1b35442c6143931edc0189a3432fb">nWidth</a>;</div><div class="line">stConvertPixelInfo.<a class="code" href="struct_m_v___f_g___c_o_n_v_e_r_t___p_i_x_e_l___i_n_f_o.html#aad74022a79f9800f72ba8ad2ced2ea95">stInputImageInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_p_u_t___i_m_a_g_e___i_n_f_o.html#a2e4c6b811457a16b7033af6741cfb1db">nHeight</a> = stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#a2e4c6b811457a16b7033af6741cfb1db">nHeight</a>;</div><div class="line">stConvertPixelInfo.<a class="code" href="struct_m_v___f_g___c_o_n_v_e_r_t___p_i_x_e_l___i_n_f_o.html#aad74022a79f9800f72ba8ad2ced2ea95">stInputImageInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_p_u_t___i_m_a_g_e___i_n_f_o.html#abc1a908f027ad8af045a2ad75df2faa3">enPixelType</a> = <a class="code" href="group___xE6_x9E_x9A_xE4_xB8_xBE_xE7_xB1_xBB_xE5_x9E_x8B_xE5_xAE_x9A_xE4_xB9_x89.html#ggaf163295ca7ce1c6b384e51346d827b90aceb846981bf786e359d0319d5169856f">MV_FG_PIXEL_TYPE_BayerRG8</a>;</div><div class="line">stConvertPixelInfo.<a class="code" href="struct_m_v___f_g___c_o_n_v_e_r_t___p_i_x_e_l___i_n_f_o.html#aad74022a79f9800f72ba8ad2ced2ea95">stInputImageInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_p_u_t___i_m_a_g_e___i_n_f_o.html#a0d04695d82775f55e4d7ed51c8c983e2">pImageBuf</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#ab48e189d395e833f208732a779e526c0">pBuffer</a>;</div><div class="line">stConvertPixelInfo.<a class="code" href="struct_m_v___f_g___c_o_n_v_e_r_t___p_i_x_e_l___i_n_f_o.html#aad74022a79f9800f72ba8ad2ced2ea95">stInputImageInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_p_u_t___i_m_a_g_e___i_n_f_o.html#a1dc2e86fcfcb0cfe25b292cc6089169e">nImageBufLen</a> = stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#ac1821e4c0315f6c0ebbcf907f835f6f6">nFilledSize</a>;</div><div class="line">stConvertPixelInfo.<a class="code" href="struct_m_v___f_g___c_o_n_v_e_r_t___p_i_x_e_l___i_n_f_o.html#a8e7a254718abdb3689156af620f74fee">stOutputImageInfo</a>.<a class="code" href="struct_m_v___f_g___o_u_t_p_u_t___i_m_a_g_e___i_n_f_o.html#abc1a908f027ad8af045a2ad75df2faa3">enPixelType</a> = <a class="code" href="group___xE6_x9E_x9A_xE4_xB8_xBE_xE7_xB1_xBB_xE5_x9E_x8B_xE5_xAE_x9A_xE4_xB9_x89.html#ggaf163295ca7ce1c6b384e51346d827b90a1d87c50f3d4a2ab9ee610bd60c2df3e8">MV_FG_PIXEL_TYPE_RGB8_Packed</a>;</div><div class="line">stConvertPixelInfo.<a class="code" href="struct_m_v___f_g___c_o_n_v_e_r_t___p_i_x_e_l___i_n_f_o.html#a8e7a254718abdb3689156af620f74fee">stOutputImageInfo</a>.<a class="code" href="struct_m_v___f_g___o_u_t_p_u_t___i_m_a_g_e___i_n_f_o.html#a9aa85da046bacbf4b7a2b31e61bf3a47">nImageBufSize</a> = stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#abbc1b35442c6143931edc0189a3432fb">nWidth</a> * stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#a2e4c6b811457a16b7033af6741cfb1db">nHeight</a> * 3;</div><div class="line">stConvertPixelInfo.<a class="code" href="struct_m_v___f_g___c_o_n_v_e_r_t___p_i_x_e_l___i_n_f_o.html#a8e7a254718abdb3689156af620f74fee">stOutputImageInfo</a>.<a class="code" href="struct_m_v___f_g___o_u_t_p_u_t___i_m_a_g_e___i_n_f_o.html#a0d04695d82775f55e4d7ed51c8c983e2">pImageBuf</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)malloc(stConvertPixelInfo.<a class="code" href="struct_m_v___f_g___c_o_n_v_e_r_t___p_i_x_e_l___i_n_f_o.html#a8e7a254718abdb3689156af620f74fee">stOutputImageInfo</a>.<a class="code" href="struct_m_v___f_g___o_u_t_p_u_t___i_m_a_g_e___i_n_f_o.html#a9aa85da046bacbf4b7a2b31e61bf3a47">nImageBufSize</a>);</div><div class="line">stConvertPixelInfo.<a class="code" href="struct_m_v___f_g___c_o_n_v_e_r_t___p_i_x_e_l___i_n_f_o.html#a7c510d92014729fb4e05916a04ae5ebe">enCfaMethod</a> = <a class="code" href="group___xE6_x9E_x9A_xE4_xB8_xBE_xE7_xB1_xBB_xE5_x9E_x8B_xE5_xAE_x9A_xE4_xB9_x89.html#gga43ecafe80a7f8258da82fbeb3f13c340ac26e37b9b9b1b3bd7f607e21437f5ddc">MV_FG_CFA_METHOD_OPTIMAL</a>;</div><div class="line"></div><div class="line"><span class="comment">/*开启平滑使能，仅Bayer插值时有效*/</span></div><div class="line">stConvertPixelInfo.<a class="code" href="struct_m_v___f_g___c_o_n_v_e_r_t___p_i_x_e_l___i_n_f_o.html#ae091d8a57bd36c45837c51b440d883bf">bFilterEnable</a>= TURE;</div><div class="line"></div><div class="line"><span class="comment">/*可配置Gamma校正使能和参数，当前关闭。仅Bayer插值时有效，支持Gamma值和Gamma曲线等多种类型*/</span></div><div class="line">stConvertPixelInfo.<a class="code" href="struct_m_v___f_g___c_o_n_v_e_r_t___p_i_x_e_l___i_n_f_o.html#a38a9b0fe62481aa9b5e9fb9c2c2c896a">stGammaInfo</a>.<a class="code" href="struct_m_v___f_g___g_a_m_m_a___i_n_f_o.html#aa7a73de0e9f1190558f87f7574aade7c">enGammaType</a> = <a class="code" href="group___xE6_x9E_x9A_xE4_xB8_xBE_xE7_xB1_xBB_xE5_x9E_x8B_xE5_xAE_x9A_xE4_xB9_x89.html#gga6a32131cf9fd6734a262e995eb1ec2beada69519755d39974788b4ea531c283f7">MV_FG_GAMMA_TYPE_NONE</a>;</div><div class="line"></div><div class="line"><span class="comment">/*可配置CCM校正使能和参数，当前关闭。仅Bayer插值时有效，支持不同量化系数*/</span></div><div class="line">stConvertPixelInfo.<a class="code" href="struct_m_v___f_g___c_o_n_v_e_r_t___p_i_x_e_l___i_n_f_o.html#a468c734256b3c715d9a2eae20a62cc07">stCCMInfo</a>.<a class="code" href="struct_m_v___f_g___c_c_m___i_n_f_o.html#af946c96e31b42bcc7b3bedde3f92a276">bCCMEnable</a> = FALSE;</div><div class="line">nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86_xE6_x8E_xA5_xE5_x8F_xA3.html#gaad1d64970f2fcb2f896eb2164a37bcea">MV_FG_ConvertPixelType</a>(hStream<span class="comment">/*hInterface*/</span><span class="comment">/*hDevice*/</span>, &amp;stConvertPixelInfo);</div><div class="line">Check(nRet);</div></div><!-- fragment --> <br />
 </div><div class="header" style="margin-left:-12px;margin-top:-10px;margin-right:-8px;"> <div class="headertitle"> <div id="jiematuxiang" class="title">解码图像</div> </div> </div> <div id="hikvision"> <br />
 </div><div id="hikvision">工业采集卡SDK支持HB码流和JPEG图像两种格式的解码功能。</div><div id="hikvision"> <ul>
<li>
通过调用 <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86_xE6_x8E_xA5_xE5_x8F_xA3.html#gaadc1870abe7dcfb0142e5a971fb1d6d6" title="无损解码">MV_FG_HB_Decode()</a> 接口，将从相机中获取到的HB无损码流数据解码成原始图像数据。HB无损码流数据是指相机通过算法将原始图像进行无损编码压缩后的数据，用户无法直接使用该码流数据，需要先调用SDK接口进行解码。应当注意的是，使用该技术在一定程度上可以提升相机帧率和突破带宽限制，但在PC端解码是耗时的，并会消耗部分系统资源。<br />
 <div class="fragment"><div class="line"><span class="comment">/*HB无损解码*/</span></div><div class="line"><a class="code" href="struct_m_v___f_g___h_b___d_e_c_o_d_e___p_a_r_a_m.html">MV_FG_HB_DECODE_PARAM</a> stHBDecode = {0};</div><div class="line">stHBDecode.<a class="code" href="struct_m_v___f_g___h_b___d_e_c_o_d_e___p_a_r_a_m.html#a01cabcdb6eb04d42ea699fc45bf21375">pSrcBuf</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#ab48e189d395e833f208732a779e526c0">pBuffer</a>;</div><div class="line">stHBDecode.<a class="code" href="struct_m_v___f_g___h_b___d_e_c_o_d_e___p_a_r_a_m.html#a6860d280bb5b78e359935494d503b469">nSrcLen</a> = stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#ac1821e4c0315f6c0ebbcf907f835f6f6">nFilledSize</a>;</div><div class="line">stHBDecode.<a class="code" href="struct_m_v___f_g___h_b___d_e_c_o_d_e___p_a_r_a_m.html#a8e7a254718abdb3689156af620f74fee">stOutputImageInfo</a>.<a class="code" href="struct_m_v___f_g___o_u_t_p_u_t___i_m_a_g_e___i_n_f_o.html#a9aa85da046bacbf4b7a2b31e61bf3a47">nImageBufSize</a> = 0;</div><div class="line">stHBDecode.<a class="code" href="struct_m_v___f_g___h_b___d_e_c_o_d_e___p_a_r_a_m.html#a8e7a254718abdb3689156af620f74fee">stOutputImageInfo</a>.<a class="code" href="struct_m_v___f_g___o_u_t_p_u_t___i_m_a_g_e___i_n_f_o.html#a0d04695d82775f55e4d7ed51c8c983e2">pImageBuf</a> = NULL;</div><div class="line">nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86_xE6_x8E_xA5_xE5_x8F_xA3.html#gaadc1870abe7dcfb0142e5a971fb1d6d6">MV_FG_HB_Decode</a>(hStream<span class="comment">/*hInterface*/</span><span class="comment">/*hDevice*/</span>, &amp;stHBDecode);</div><div class="line"><span class="keywordflow">if</span>(<a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86_xE9_x94_x99_xE8_xAF_xAF_xE7_xA0_x81.html#ga7fea2431ad7d9b74bd8797efceaebfc0">MV_FG_ERR_IMG_OVERFLOW</a> == nRet)</div><div class="line">{</div><div class="line">    stHBDecode.<a class="code" href="struct_m_v___f_g___h_b___d_e_c_o_d_e___p_a_r_a_m.html#a8e7a254718abdb3689156af620f74fee">stOutputImageInfo</a>.<a class="code" href="struct_m_v___f_g___o_u_t_p_u_t___i_m_a_g_e___i_n_f_o.html#a0d04695d82775f55e4d7ed51c8c983e2">pImageBuf</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)malloc(stHBDecode.<a class="code" href="struct_m_v___f_g___h_b___d_e_c_o_d_e___p_a_r_a_m.html#a8e7a254718abdb3689156af620f74fee">stOutputImageInfo</a>.<a class="code" href="struct_m_v___f_g___o_u_t_p_u_t___i_m_a_g_e___i_n_f_o.html#a1dc2e86fcfcb0cfe25b292cc6089169e">nImageBufLen</a>);</div><div class="line">    stHBDecode.<a class="code" href="struct_m_v___f_g___h_b___d_e_c_o_d_e___p_a_r_a_m.html#a8e7a254718abdb3689156af620f74fee">stOutputImageInfo</a>.<a class="code" href="struct_m_v___f_g___o_u_t_p_u_t___i_m_a_g_e___i_n_f_o.html#a9aa85da046bacbf4b7a2b31e61bf3a47">nImageBufSize</a> = stHBDecode.<a class="code" href="struct_m_v___f_g___h_b___d_e_c_o_d_e___p_a_r_a_m.html#a8e7a254718abdb3689156af620f74fee">stOutputImageInfo</a>.<a class="code" href="struct_m_v___f_g___o_u_t_p_u_t___i_m_a_g_e___i_n_f_o.html#a1dc2e86fcfcb0cfe25b292cc6089169e">nImageBufLen</a>;</div><div class="line">    nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86_xE6_x8E_xA5_xE5_x8F_xA3.html#gaadc1870abe7dcfb0142e5a971fb1d6d6">MV_FG_HB_Decode</a>(hStream<span class="comment">/*hInterface*/</span><span class="comment">/*hDevice*/</span>, &amp; stHBDecode);</div><div class="line">    Check(nRet);</div><div class="line">}</div></div><!-- fragment -->  </li>
<li>
通过调用 <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86_xE6_x8E_xA5_xE5_x8F_xA3.html#ga5135cbcd10c00691f06acd9af4a75026" title="JPEG解码">MV_FG_DecodeJpeg()</a> 接口，将从相机中获取到的JPEG码流数据解码成图像数据。其中黑白的会解码成8bit的Mono8灰度图，彩色的会解码成24bit的RGB24彩色图。<br />
 <div class="fragment"><div class="line"><span class="comment">/*JPEG解码*/</span></div><div class="line"><a class="code" href="struct_m_v___f_g___d_e_c_o_d_e___j_p_e_g___p_a_r_a_m.html">MV_FG_DECODE_JPEG_PARAM</a> stDecodeJPEG = {0};</div><div class="line">stDecodeJPEG.<a class="code" href="struct_m_v___f_g___d_e_c_o_d_e___j_p_e_g___p_a_r_a_m.html#a01cabcdb6eb04d42ea699fc45bf21375">pSrcBuf</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#ab48e189d395e833f208732a779e526c0">pBuffer</a>;</div><div class="line">stDecodeJPEG.<a class="code" href="struct_m_v___f_g___d_e_c_o_d_e___j_p_e_g___p_a_r_a_m.html#a6860d280bb5b78e359935494d503b469">nSrcLen</a> = stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#ac1821e4c0315f6c0ebbcf907f835f6f6">nFilledSize</a>;</div><div class="line">stDecodeJPEG.<a class="code" href="struct_m_v___f_g___d_e_c_o_d_e___j_p_e_g___p_a_r_a_m.html#a8e7a254718abdb3689156af620f74fee">stOutputImageInfo</a>.<a class="code" href="struct_m_v___f_g___o_u_t_p_u_t___i_m_a_g_e___i_n_f_o.html#a9aa85da046bacbf4b7a2b31e61bf3a47">nImageBufSize</a> = 0;</div><div class="line">stDecodeJPEG.<a class="code" href="struct_m_v___f_g___d_e_c_o_d_e___j_p_e_g___p_a_r_a_m.html#a8e7a254718abdb3689156af620f74fee">stOutputImageInfo</a>.<a class="code" href="struct_m_v___f_g___o_u_t_p_u_t___i_m_a_g_e___i_n_f_o.html#a0d04695d82775f55e4d7ed51c8c983e2">pImageBuf</a> = NULL;</div><div class="line">nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86_xE6_x8E_xA5_xE5_x8F_xA3.html#ga5135cbcd10c00691f06acd9af4a75026">MV_FG_DecodeJpeg</a>(hStream<span class="comment">/*hInterface*/</span><span class="comment">/*hDevice*/</span>, &amp;stDecodeJPEG);</div><div class="line"><span class="keywordflow">if</span>(<a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86_xE9_x94_x99_xE8_xAF_xAF_xE7_xA0_x81.html#ga7fea2431ad7d9b74bd8797efceaebfc0">MV_FG_ERR_IMG_OVERFLOW</a> == nRet)</div><div class="line">{</div><div class="line">    stDecodeJPEG.<a class="code" href="struct_m_v___f_g___d_e_c_o_d_e___j_p_e_g___p_a_r_a_m.html#a8e7a254718abdb3689156af620f74fee">stOutputImageInfo</a>.<a class="code" href="struct_m_v___f_g___o_u_t_p_u_t___i_m_a_g_e___i_n_f_o.html#a0d04695d82775f55e4d7ed51c8c983e2">pImageBuf</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)malloc(stDecodeJPEG.<a class="code" href="struct_m_v___f_g___d_e_c_o_d_e___j_p_e_g___p_a_r_a_m.html#a8e7a254718abdb3689156af620f74fee">stOutputImageInfo</a>.<a class="code" href="struct_m_v___f_g___o_u_t_p_u_t___i_m_a_g_e___i_n_f_o.html#a1dc2e86fcfcb0cfe25b292cc6089169e">nImageBufLen</a>);</div><div class="line">    stDecodeJPEG.<a class="code" href="struct_m_v___f_g___d_e_c_o_d_e___j_p_e_g___p_a_r_a_m.html#a8e7a254718abdb3689156af620f74fee">stOutputImageInfo</a>.<a class="code" href="struct_m_v___f_g___o_u_t_p_u_t___i_m_a_g_e___i_n_f_o.html#a9aa85da046bacbf4b7a2b31e61bf3a47">nImageBufSize</a> = stDecodeJPEG.<a class="code" href="struct_m_v___f_g___d_e_c_o_d_e___j_p_e_g___p_a_r_a_m.html#a8e7a254718abdb3689156af620f74fee">stOutputImageInfo</a>.<a class="code" href="struct_m_v___f_g___o_u_t_p_u_t___i_m_a_g_e___i_n_f_o.html#a1dc2e86fcfcb0cfe25b292cc6089169e">nImageBufLen</a>;</div><div class="line">    nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86_xE6_x8E_xA5_xE5_x8F_xA3.html#ga5135cbcd10c00691f06acd9af4a75026">MV_FG_DecodeJpeg</a>(hStream<span class="comment">/*hInterface*/</span><span class="comment">/*hDevice*/</span>, &amp; stDecodeJPEG);</div><div class="line">    Check(nRet);</div><div class="line">}</div></div><!-- fragment -->  </li>
</ul>
<br />
 </div><div class="header" style="margin-left:-12px;margin-top:-10px;margin-right:-8px;"> <div class="headertitle"> <div id="chongzutuxiang" class="title">重组图像</div> </div> </div> <div id="hikvision"> <br />
 </div><div id="hikvision">通过调用 <a class="el" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86_xE6_x8E_xA5_xE5_x8F_xA3.html#gaef7831d4dee9102a19967981bedf5dfe" title="重组图像">MV_FG_ReconstructImage()</a> 接口，输入图像信息，可以对图像进行旋转（90°/180°/270°）、翻转（水平和垂直）和按行拆分等操作，具体操作模式可以参考<a class="el" href="group___xE6_x9E_x9A_xE4_xB8_xBE_xE7_xB1_xBB_xE5_x9E_x8B_xE5_xAE_x9A_xE4_xB9_x89.html#gaa21daa3915152627e5592fd72d07f83f">MV_FG_RECONSTRUCT_MODE</a> 。其中，图像旋转和图像翻转支持的像素格式为Mono8/RGB24/BGR24。图像按行拆分应与线阵相机的分时曝光功能配合使用，可以按实际曝光值个数对图像进行拆分，若使用面阵相机或者未开启分时曝光功能，则该功能并无实际意义。</div><div id="hikvision"> <div class="fragment"><div class="line"><span class="comment">/*图像重组，分时曝光中的按行拆分为例*/</span></div><div class="line"><a class="code" href="struct_m_v___f_g___r_e_c_o_n_s_t_r_u_c_t___i_n_f_o.html">MV_FG_RECONSTRUCT_INFO</a> stReconstructInfo = {0};</div><div class="line"></div><div class="line"><span class="comment">/*相机的曝光个数*/</span></div><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nExposureNum = 3;</div><div class="line"></div><div class="line">stReconstructInfo.<a class="code" href="struct_m_v___f_g___r_e_c_o_n_s_t_r_u_c_t___i_n_f_o.html#aad74022a79f9800f72ba8ad2ced2ea95">stInputImageInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_p_u_t___i_m_a_g_e___i_n_f_o.html#abbc1b35442c6143931edc0189a3432fb">nWidth</a> = stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#abbc1b35442c6143931edc0189a3432fb">nWidth</a>;</div><div class="line">stReconstructInfo.<a class="code" href="struct_m_v___f_g___r_e_c_o_n_s_t_r_u_c_t___i_n_f_o.html#aad74022a79f9800f72ba8ad2ced2ea95">stInputImageInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_p_u_t___i_m_a_g_e___i_n_f_o.html#a2e4c6b811457a16b7033af6741cfb1db">nHeight</a> = stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#a2e4c6b811457a16b7033af6741cfb1db">nHeight</a>;</div><div class="line">stReconstructInfo.<a class="code" href="struct_m_v___f_g___r_e_c_o_n_s_t_r_u_c_t___i_n_f_o.html#aad74022a79f9800f72ba8ad2ced2ea95">stInputImageInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_p_u_t___i_m_a_g_e___i_n_f_o.html#abc1a908f027ad8af045a2ad75df2faa3">enPixelType</a> = <a class="code" href="group___xE6_x9E_x9A_xE4_xB8_xBE_xE7_xB1_xBB_xE5_x9E_x8B_xE5_xAE_x9A_xE4_xB9_x89.html#ggaf163295ca7ce1c6b384e51346d827b90a1d87c50f3d4a2ab9ee610bd60c2df3e8">MV_FG_PIXEL_TYPE_RGB8_Packed</a>;</div><div class="line">stReconstructInfo.<a class="code" href="struct_m_v___f_g___r_e_c_o_n_s_t_r_u_c_t___i_n_f_o.html#aad74022a79f9800f72ba8ad2ced2ea95">stInputImageInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_p_u_t___i_m_a_g_e___i_n_f_o.html#a0d04695d82775f55e4d7ed51c8c983e2">pImageBuf</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#ab48e189d395e833f208732a779e526c0">pBuffer</a>;</div><div class="line">stReconstructInfo.<a class="code" href="struct_m_v___f_g___r_e_c_o_n_s_t_r_u_c_t___i_n_f_o.html#aad74022a79f9800f72ba8ad2ced2ea95">stInputImageInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_p_u_t___i_m_a_g_e___i_n_f_o.html#a1dc2e86fcfcb0cfe25b292cc6089169e">nImageBufLen</a> = stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#ac1821e4c0315f6c0ebbcf907f835f6f6">nFilledSize</a>;</div><div class="line">for (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nExposureNum; i++)</div><div class="line">{</div><div class="line">    stReconstructInfo.<a class="code" href="struct_m_v___f_g___r_e_c_o_n_s_t_r_u_c_t___i_n_f_o.html#a8a512374dfdcd43a11f77f139feaf916">stOutputImageInfo</a>[i].<a class="code" href="struct_m_v___f_g___o_u_t_p_u_t___i_m_a_g_e___i_n_f_o.html#a9aa85da046bacbf4b7a2b31e61bf3a47">nImageBufSize</a> = stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#ac1821e4c0315f6c0ebbcf907f835f6f6">nFilledSize</a> / nExposureNum;</div><div class="line">    stReconstructInfo.<a class="code" href="struct_m_v___f_g___r_e_c_o_n_s_t_r_u_c_t___i_n_f_o.html#a8a512374dfdcd43a11f77f139feaf916">stOutputImageInfo</a>[i].<a class="code" href="struct_m_v___f_g___o_u_t_p_u_t___i_m_a_g_e___i_n_f_o.html#a0d04695d82775f55e4d7ed51c8c983e2">pImageBuf</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)malloc(stFrameInfo.<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#ac1821e4c0315f6c0ebbcf907f835f6f6">nFilledSize</a> / nExposureNum);</div><div class="line">}</div><div class="line">nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE5_xA4_x84_xE7_x90_x86_xE6_x8E_xA5_xE5_x8F_xA3.html#gaef7831d4dee9102a19967981bedf5dfe">MV_FG_ReconstructImage</a>(hStream<span class="comment">/*hInterface*/</span><span class="comment">/*hDevice*/</span>, &amp;stReconstructInfo);</div><div class="line">Check(nRet);</div></div><!-- fragment --> <br />
 </div> </div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<div class="footer" style="text-align: right;">
	<hr/>
	<small></small>
</div>
</body>
</html>